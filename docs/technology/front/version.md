# package.json版本号介绍

转自: <https://segmentfault.com/a/1190000019935845>
转自: <https://www.cnblogs.com/yalong/p/15013880.html>

## 语义化版本

使用第三方依赖时，通常需要指定依赖的版本范围，比如

```json
{
    ...
    "dependencies":{
      "antd": "3.1.2",
      "react": "~16.0.1",
      "redux": "^3.7.2",
      "lodash": "*"
    }
    ...
}
```

上面的 package.json 文件表明，项目中使用的 antd 的版本号是 3.1.2，但是 3.1.1 和 3.1.2、3.0.1、2.1.1 之间有什么不同呢。

<!-- more -->

语义化版本规则规定，版本格式为：`主版本号.次版本号.修订号`，并且版本号的递增规则如下：

* **主版本号**：当你做了不兼容的 API 修改
* **次版本号**：当你做了向下兼容的功能性新增
* **修订号**：当你做了向下兼容的问题修正

* **主版本号**的更新通常意味着大的修改和更新，升级主版本后可能会使你的程序报错，因此升级主版本号需谨慎，但是这往往也会带来更好的性能和体验。
* **次版本号**的更新则通常意味着新增了某些特性，比如 antd 的版本从 3.1.1 升级到 3.1.2，之前的 Select 组件不支持搜索功能，升级之后支持了搜索。
* **修订号**的更新则往往意味着进行了一些 bug 修复。因此次版本号和修订号应该保持更新，这样能让你之前的代码不会报错还能获取到最新的功能特性。

但是，往往我们不会指定依赖的具体版本，而是指定版本范围，比如上面的 package.json 文件里的 react、redux 以及 lodash，这三个依赖分别使用了三个符号来表明依赖的版本范围。语义化版本范围规定：

* `*`：升级到最新版本
* `^`：升级次版本号和修订号
* `~`：只升级修订号

因此，上面的 package.json 文件安装的依赖版本范围如下：

```shell
react@~16.0.1：>=react@16.0.1 && < react@16.1.0
redux@^3.7.2：>=redux@3.7.2 && < redux@4.0.0
lodash@*：lodash@latest
```

## 版本的格式

**major.minor.patch** 代表 **主版本号.次版本号.修补版本号**:

* **major**：新的架构调整，不兼容老版本
* **minor**：新增功能，兼容老版本
* **patch**：修复bug，兼容老版本

## 依赖版本号规则

### **version**

* 必须匹配某个版本
* 如：1.1.2，表示必须依赖1.1.2版

### **\>version**

* 必须大于某个版本
* 如：>1.1.2，表示必须大于1.1.2版

### **\>=version**

* 可大于或等于某个版本
* 如：>=1.1.2，表示可以等于1.1.2，也可以大于1.1.2版本

### **<version**

* 必须小于某个版本
* 如：<1.1.2，表示必须小于1.1.2版本

### **<=version**

* 可以小于或等于某个版本
* 如：<=1.1.2，表示可以等于1.1.2，也可以小于1.1.2版本

### **~version**

* 大概匹配某个版本
* 如果minor版本号指定了，那么minor版本号不变，而patch版本号任意
* 如果minor和patch版本号未指定，那么minor和patch版本号任意
* 如：~1.1.2，表示>=1.1.2 <1.2.0，可以是1.1.2，1.1.3，1.1.4，.....，1.1.n
* 如：~1.1，表示>=1.1.0 <1.2.0，可以是同上
* 如：~1，表示>=1.0.0 <2.0.0，可以是1.0.0，1.0.1，1.0.2，.....，1.0.n，1.1.n，1.2.n，.....，1.n.n

### **^version**

* 兼容某个版本
* 版本号中最左边的非0数字的右侧可以任意
* 如果缺少某个版本号，则这个版本号的位置可以任意
* 如：^1.1.2 ，表示>=1.1.2 <2.0.0，可以是1.1.2，1.1.3，.....，1.1.n，1.2.n，.....，1.n.n
* 如：^0.2.3 ，表示>=0.2.3 <0.3.0，可以是0.2.3，0.2.4，.....，0.2.n
* 如：^0.0，表示 >=0.0.0 <0.1.0，可以是0.0.0，0.0.1，.....，0.0.n

### **x-range**

* x的位置表示任意版本
* 如：1.2.x，表示可以1.2.0，1.2.1，.....，1.2.n

### **\*-range**

* 任意版本，""也表示任意版本
* 如：\*，表示>=0.0.0的任意版本

### **version1 - version2**

* 大于等于version1，小于等于version2
* 如：1.1.2 - 1.3.1，表示包括1.1.2和1.3.1以及他们件的任意版本

### **range1 || range2**

* 满足range1或者满足range2，可以多个范围
* 如：=2.3.1 =2.5.2 <3.0.0，表示满足这3个范围的版本都可以
