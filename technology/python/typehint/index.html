
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="hellowac的工作学习生活笔记">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../pep8/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.7">
    
    
      
        <title>类型标注 - 我的工作学习生活笔记</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="default" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#类型标注" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="我的工作学习生活笔记" class="md-header__button md-logo" aria-label="我的工作学习生活笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            我的工作学习生活笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              类型标注
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/hellowac.github.io/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac的个人博客
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      首页
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        技术
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../read/english/bluelevel/" class="md-tabs__link">
        阅读
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../invest/webs/" class="md-tabs__link">
        理财
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../tools/repos/" class="md-tabs__link">
        工具
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../documents/docs/" class="md-tabs__link">
        文档
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../e-book/" class="md-tabs__link">
      电子书
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../other/front_links/" class="md-tabs__link">
        其他
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../about/" class="md-tabs__link">
      关于
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="我的工作学习生活笔记" class="md-nav__button md-logo" aria-label="我的工作学习生活笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    我的工作学习生活笔记
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/hellowac.github.io/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac的个人博客
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          技术
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          技术
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        简介
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          类型标注
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        类型标注
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#相关的-pep" class="md-nav__link">
    相关的 PEP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#类型别名" class="md-nav__link">
    类型别名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#newtype" class="md-nav__link">
    NewType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#可调对象callable" class="md-nav__link">
    可调对象（Callable）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#泛型generic" class="md-nav__link">
    泛型（Generic）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#用户定义的泛型类型" class="md-nav__link">
    用户定义的泛型类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#any-类型" class="md-nav__link">
    Any 类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#名义子类型-vs-结构子类型" class="md-nav__link">
    名义子类型 vs 结构子类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#模块内容" class="md-nav__link">
    模块内容
  </a>
  
    <nav class="md-nav" aria-label="模块内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#特殊类型原语" class="md-nav__link">
    特殊类型原语
  </a>
  
    <nav class="md-nav" aria-label="特殊类型原语">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#特殊类型" class="md-nav__link">
    特殊类型
  </a>
  
    <nav class="md-nav" aria-label="特殊类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingany" class="md-nav__link">
    typing.Any
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingnoreturn" class="md-nav__link">
    typing.NoReturn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtypealias" class="md-nav__link">
    typing.TypeAlias
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#特殊形式" class="md-nav__link">
    特殊形式
  </a>
  
    <nav class="md-nav" aria-label="特殊形式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingtuple" class="md-nav__link">
    typing.Tuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingunion" class="md-nav__link">
    typing.Union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingoptional" class="md-nav__link">
    typing.Optional
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingcallable" class="md-nav__link">
    typing.Callable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingconcatenate" class="md-nav__link">
    typing.Concatenate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypegenericct_co" class="md-nav__link">
    class typing.Type(Generic[CT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingliteral" class="md-nav__link">
    typing.Literal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingclassvar" class="md-nav__link">
    typing.ClassVar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingfinal" class="md-nav__link">
    typing.Final
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingannotated" class="md-nav__link">
    typing.Annotated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtypeguard" class="md-nav__link">
    typing.TypeGuard
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#构建泛型类型" class="md-nav__link">
    构建泛型类型
  </a>
  
    <nav class="md-nav" aria-label="构建泛型类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typinggeneric" class="md-nav__link">
    class typing.Generic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypevar" class="md-nav__link">
    class typing.TypeVar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingparamspec" class="md-nav__link">
    class typing.ParamSpec
  </a>
  
    <nav class="md-nav" aria-label="class typing.ParamSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kwargs" class="md-nav__link">
    Kwargs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingparamspecargs" class="md-nav__link">
    typing.ParamSpecArgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingparamspeckwargs" class="md-nav__link">
    typing.ParamSpecKwargs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typinganystr" class="md-nav__link">
    typing.AnyStr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingprotocolgeneric" class="md-nav__link">
    class typing.Protocol(Generic)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingruntime_checkable" class="md-nav__link">
    @typing.runtime_checkable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#其他特殊指令" class="md-nav__link">
    其他特殊指令
  </a>
  
    <nav class="md-nav" aria-label="其他特殊指令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingnamedtuple" class="md-nav__link">
    class typing.NamedTuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingnewtypename-tp" class="md-nav__link">
    class typing.NewType(name, tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypeddictdict" class="md-nav__link">
    class typing.TypedDict(dict)
  </a>
  
    <nav class="md-nav" aria-label="class typing.TypedDict(dict)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__total__" class="md-nav__link">
    __total__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#__required_keys__" class="md-nav__link">
    __required_keys__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#__optional_keys__" class="md-nav__link">
    __optional_keys__
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#泛型具象容器" class="md-nav__link">
    泛型具象容器
  </a>
  
    <nav class="md-nav" aria-label="泛型具象容器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#对应的内置类型" class="md-nav__link">
    对应的内置类型
  </a>
  
    <nav class="md-nav" aria-label="对应的内置类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingdictdict-mutablemappingkt-vt" class="md-nav__link">
    class typing.Dict(dict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinglistlist-mutablesequencet" class="md-nav__link">
    class typing.List(list, MutableSequence[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsetset-mutablesett" class="md-nav__link">
    class typing.Set(set, MutableSet[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingfrozensetfrozenset-abstractsett_co" class="md-nav__link">
    class typing.FrozenSet(frozenset, AbstractSet[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collections-对应类型" class="md-nav__link">
    collections 对应类型
  </a>
  
    <nav class="md-nav" aria-label="collections 对应类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingdefaultdictcollectionsdefaultdict-mutablemappingkt-vt" class="md-nav__link">
    class typing.DefaultDict(collections.defaultdict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingordereddictcollectionsordereddict-mutablemappingkt-vt" class="md-nav__link">
    class typing.OrderedDict(collections.OrderedDict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingchainmapcollectionschainmap-mutablemappingkt-vt" class="md-nav__link">
    class typing.ChainMap(collections.ChainMap, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcountercollectionscounter-dictt-int" class="md-nav__link">
    class typing.Counter(collections.Counter, Dict[T, int])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingdequedeque-mutablesequencet" class="md-nav__link">
    class typing.Deque(deque, MutableSequence[T])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#其他具象类型" class="md-nav__link">
    其他具象类型
  </a>
  
    <nav class="md-nav" aria-label="其他具象类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingio" class="md-nav__link">
    class typing.IO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtextio" class="md-nav__link">
    class typing.TextIO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calss-typingbinaryio" class="md-nav__link">
    calss typing.BinaryIO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingpattern" class="md-nav__link">
    class typing.Pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmatch" class="md-nav__link">
    class typing.Match
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtext" class="md-nav__link">
    class typing.Text
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#抽象基类" class="md-nav__link">
    抽象基类
  </a>
  
    <nav class="md-nav" aria-label="抽象基类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collectionsabc-对应的容器" class="md-nav__link">
    collections.abc 对应的容器
  </a>
  
    <nav class="md-nav" aria-label="collections.abc 对应的容器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingabstractsetcollectiont_co" class="md-nav__link">
    class typing.AbstractSet(Collection[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingbytestringsequenceint" class="md-nav__link">
    class typing.ByteString(Sequence[int])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcollectionsized-iterablet_co-containert_co" class="md-nav__link">
    class typing.Collection(Sized, Iterable[T_co], Container[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcontainergenerict_co" class="md-nav__link">
    class typing.Container(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingitemsviewmappingview-abstractsettuplekt_co-vt_co" class="md-nav__link">
    class typing.ItemsView(MappingView, AbstractSet[tuple[KT_co, VT_co]])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingkeysviewmappingview-abstractsetkt_co" class="md-nav__link">
    class typing.KeysView(MappingView, AbstractSet[KT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmappingcollectionkt-generickt-vt_co" class="md-nav__link">
    class typing.Mapping(Collection[KT], Generic[KT, VT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmappingviewsized" class="md-nav__link">
    class typing.MappingView(Sized)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablemappingmappingkt-vt" class="md-nav__link">
    class typing.MutableMapping(Mapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablesequencesequencet" class="md-nav__link">
    class typing.MutableSequence(Sequence[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablesetabstractsett" class="md-nav__link">
    class typing.MutableSet(AbstractSet[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsequencereversiblet_co-collectiont_co" class="md-nav__link">
    class typing.Sequence(Reversible[T_co], Collection[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingvaluesviewmappingview-collection_vt_co" class="md-nav__link">
    class typing.ValuesView(MappingView, Collection[_VT_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collectionsabc-对应的其他类型" class="md-nav__link">
    collections.abc 对应的其他类型
  </a>
  
    <nav class="md-nav" aria-label="collections.abc 对应的其他类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingiterablegenerict_co" class="md-nav__link">
    class typing.Iterable(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingiteratoriterablet_co" class="md-nav__link">
    class typing.Iterator(Iterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinggeneratoriteratort_co-generict_co-t_contra-v_co" class="md-nav__link">
    class typing.Generator(Iterator[T_co], Generic[T_co, T_contra, V_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinghashable" class="md-nav__link">
    class typing.Hashable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingreversibleiterablet_co" class="md-nav__link">
    class typing.Reversible(Iterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsized" class="md-nav__link">
    class typing.Sized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#异步编程" class="md-nav__link">
    异步编程
  </a>
  
    <nav class="md-nav" aria-label="异步编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingcoroutineawaitablev_co-generict_co-t_contra-v_co" class="md-nav__link">
    class typing.Coroutine(Awaitable[V_co], Generic[T_co, T_contra, V_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasyncgeneratorasynciteratort_co-generict_co-t_contra" class="md-nav__link">
    class typing.AsyncGenerator(AsyncIterator[T_co], Generic[T_co, T_contra])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynciterablegenerict_co" class="md-nav__link">
    class typing.AsyncIterable(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynciteratorasynciterablet_co" class="md-nav__link">
    class typing.AsyncIterator(AsyncIterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingawaitablegenerict_co" class="md-nav__link">
    class typing.Awaitable(Generic[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#上下文管理器类型" class="md-nav__link">
    上下文管理器类型
  </a>
  
    <nav class="md-nav" aria-label="上下文管理器类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingcontextmanagergenerict_co" class="md-nav__link">
    class typing.ContextManager(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynccontextmanagergenerict_co" class="md-nav__link">
    class typing.AsyncContextManager(Generic[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#协议" class="md-nav__link">
    协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#函数与装饰器" class="md-nav__link">
    函数与装饰器
  </a>
  
    <nav class="md-nav" aria-label="函数与装饰器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingcasttyp-val" class="md-nav__link">
    typing.cast(typ, val)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingoverload" class="md-nav__link">
    @typing.overload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingfinal_1" class="md-nav__link">
    @typing.final
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingno_type_check" class="md-nav__link">
    @typing.no_type_check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingno_type_check_decorator" class="md-nav__link">
    @typing.no_type_check_decorator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtype_check_only" class="md-nav__link">
    @typing.type_check_only
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#内省辅助器" class="md-nav__link">
    内省辅助器
  </a>
  
    <nav class="md-nav" aria-label="内省辅助器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingget_type_hintsobj-globalnsnone-localnsnone-include_extrasfalse" class="md-nav__link">
    typing.get_type_hints(obj, globalns=None, localns=None, include_extras=False)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingget_argstp" class="md-nav__link">
    typing.get_args(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingget_origintp" class="md-nav__link">
    typing.get_origin(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingis_typeddicttp" class="md-nav__link">
    typing.is_typeddict(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingforwardref" class="md-nav__link">
    class typing.ForwardRef
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#常量" class="md-nav__link">
    常量
  </a>
  
    <nav class="md-nav" aria-label="常量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingtype_checking" class="md-nav__link">
    typing.TYPE_CHECKING
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pep8/" class="md-nav__link">
        PEP 8 – Python代码样式指南
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code_style_guide/" class="md-nav__link">
        编码样式指南
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pip/" class="md-nav__link">
        pip
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stringio/" class="md-nav__link">
        stringIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flask/" class="md-nav__link">
        flask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../django/" class="md-nav__link">
        django
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../importlib/" class="md-nav__link">
        importlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pycrypto/" class="md-nav__link">
        crypto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../petl/" class="md-nav__link">
        python-petl使用简介
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../psutil/" class="md-nav__link">
        psutil文档-中文版
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docx/" class="md-nav__link">
        docx文档
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../excel/" class="md-nav__link">
        Excel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reportlab/" class="md-nav__link">
        ReportLab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alembic/" class="md-nav__link">
        alembic教程(转)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sqlalchemy/" class="md-nav__link">
        SQLAlchemy简明教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../useful_functions/" class="md-nav__link">
        常用的函数
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/usage_source/" class="md-nav__link">
        常用资源
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/port/" class="md-nav__link">
        端口占用查找
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/disk-mount/" class="md-nav__link">
        linux磁盘挂载
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/shell-scripts/" class="md-nav__link">
        shell脚本实战
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          C
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          C
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../C/c/" class="md-nav__link">
        C基础
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          前端知识
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          前端知识
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../front/base/" class="md-nav__link">
        基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../front/project/" class="md-nav__link">
        工程化流程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../front/version/" class="md-nav__link">
        包版本知识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../front/package/" class="md-nav__link">
        package.json知识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../front/webassembly/" class="md-nav__link">
        WebAssembly
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          服务组件
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          服务组件
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../components/zookeeper/" class="md-nav__link">
        zookeeper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../components/nginx/" class="md-nav__link">
        nginx
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../components/supervisor/" class="md-nav__link">
        supervisor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../components/rabbitmq/" class="md-nav__link">
        rabbitmq
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../components/kafka/" class="md-nav__link">
        kafka
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5_6" id="__nav_2_5_6_label" tabindex="0">
          无头浏览器
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5_6">
          <span class="md-nav__icon md-icon"></span>
          无头浏览器
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unheadchrome/openchrome/" class="md-nav__link">
        openchrome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unheadchrome/build_env/" class="md-nav__link">
        环境搭建
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          数据库
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          数据库
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/clickhouse/" class="md-nav__link">
        ClickHouse
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
          MySQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6_2">
          <span class="md-nav__icon md-icon"></span>
          MySQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/mysql8_install/" class="md-nav__link">
        mysql8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/mysql/" class="md-nav__link">
        常用操作
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6_3" id="__nav_2_6_3_label" tabindex="0">
          ElasticSearch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6_3">
          <span class="md-nav__icon md-icon"></span>
          ElasticSearch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/elasticsearch_py/" class="md-nav__link">
        elasticsearch-py
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/es_dsl/" class="md-nav__link">
        elasticsearch-dsl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../database/es_aggs/" class="md-nav__link">
        elasticsearch-aggs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
          安全渗透
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          安全渗透
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/thc-hydra/" class="md-nav__link">
        hydra
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/sqlmap/" class="md-nav__link">
        sqlmap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
      
      
      
        <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
          RFC标准
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_8">
          <span class="md-nav__icon md-icon"></span>
          RFC标准
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rfc/oauth2/" class="md-nav__link">
        oauth2学习笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rfc/rfc6749/" class="md-nav__link">
        Oauth2-RFC6749翻译
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rfc/rfc6750/" class="md-nav__link">
        Oauth2-RFC6750翻译
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
      
      
      
        <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
          知识概念
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_9">
          <span class="md-nav__icon md-icon"></span>
          知识概念
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/project_doc_layout/" class="md-nav__link">
        项目文档结构示例
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/pc/" class="md-nav__link">
        上位机简介
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/xaas/" class="md-nav__link">
        xaas概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/xaas2/" class="md-nav__link">
        一文搞懂什么是SaaS、BaaS、PaaS和IaaS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/users/" class="md-nav__link">
        统一用户管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/etl/" class="md-nav__link">
        ETL数据处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/data_transfer/" class="md-nav__link">
        数据传输和对接
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/understand_computer_system/" class="md-nav__link">
        深入理解计算机系统
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
      
      
      
        <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
          其他
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_10">
          <span class="md-nav__icon md-icon"></span>
          其他
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/embedded_industry/" class="md-nav__link">
        嵌入式行业
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/apache_license2/" class="md-nav__link">
        apache license2.0开源协议
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          阅读
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          阅读
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          英语
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          英语
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/english/bluelevel/" class="md-nav__link">
        BlueLevel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/english/redlevel/" class="md-nav__link">
        RedLevel
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/howtoreadbook/" class="md-nav__link">
        如何阅读一本书
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/howtoavoid/" class="md-nav__link">
        如何避免愚蠢的见识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/placeofsoul/" class="md-nav__link">
        灵魂的最高处
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/maliciousmatch/" class="md-nav__link">
        恶意匹配
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          沟通的艺术
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          沟通的艺术
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication01/" class="md-nav__link">
        沟通入门
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication02/" class="md-nav__link">
        看入人里:自我
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication03/" class="md-nav__link">
        看入人里:知觉
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication04/" class="md-nav__link">
        看入人里:情绪
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication05/" class="md-nav__link">
        看出人外:语言
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication06/" class="md-nav__link">
        看出人外:非语言沟通
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication07/" class="md-nav__link">
        看出人外:倾听
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication08/" class="md-nav__link">
        看人之间:沟通和关系的演变
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication09/" class="md-nav__link">
        看人之间:人际沟通中的亲密关系
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication10/" class="md-nav__link">
        看人之间:增进沟通气氛
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication11/" class="md-nav__link">
        看人之间:处理人际冲突
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../read/book/artofcommunication12/" class="md-nav__link">
        阅读总结
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          理财
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          理财
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../invest/webs/" class="md-nav__link">
        理财网站
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          工具
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          工具
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/repos/" class="md-nav__link">
        仓库合集
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git1/" class="md-nav__link">
        git 起步
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git2/" class="md-nav__link">
        git 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git3/" class="md-nav__link">
        git 分支
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git4/" class="md-nav__link">
        git 服务器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git5/" class="md-nav__link">
        git 分布式
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git6/" class="md-nav__link">
        git hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git7/" class="md-nav__link">
        git 工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git8/" class="md-nav__link">
        git 自定义
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git9/" class="md-nav__link">
        git 与其他系统
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git10/" class="md-nav__link">
        git 内部原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/gita1/" class="md-nav__link">
        git 其他环境中使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/gita2/" class="md-nav__link">
        git 应用中嵌入
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/gita3/" class="md-nav__link">
        git 命令
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          文档
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          文档
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../documents/docs/" class="md-nav__link">
        文档合集
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../e-book/" class="md-nav__link">
        电子书
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          其他
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          其他
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/front_links/" class="md-nav__link">
        前端常用地址
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/back_links/" class="md-nav__link">
        后端常用地址
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/other_links/" class="md-nav__link">
        其他常用地址
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/become_leader/" class="md-nav__link">
        成为高手秘籍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/zym_weibo/" class="md-nav__link">
        张一鸣微博
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/dynamic_business/" class="md-nav__link">
        动态商业环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/honeypot_list/" class="md-nav__link">
        蜜罐资源列表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/bigdata_links/" class="md-nav__link">
        大数据资源列表
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        关于
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#相关的-pep" class="md-nav__link">
    相关的 PEP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#类型别名" class="md-nav__link">
    类型别名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#newtype" class="md-nav__link">
    NewType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#可调对象callable" class="md-nav__link">
    可调对象（Callable）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#泛型generic" class="md-nav__link">
    泛型（Generic）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#用户定义的泛型类型" class="md-nav__link">
    用户定义的泛型类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#any-类型" class="md-nav__link">
    Any 类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#名义子类型-vs-结构子类型" class="md-nav__link">
    名义子类型 vs 结构子类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#模块内容" class="md-nav__link">
    模块内容
  </a>
  
    <nav class="md-nav" aria-label="模块内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#特殊类型原语" class="md-nav__link">
    特殊类型原语
  </a>
  
    <nav class="md-nav" aria-label="特殊类型原语">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#特殊类型" class="md-nav__link">
    特殊类型
  </a>
  
    <nav class="md-nav" aria-label="特殊类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingany" class="md-nav__link">
    typing.Any
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingnoreturn" class="md-nav__link">
    typing.NoReturn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtypealias" class="md-nav__link">
    typing.TypeAlias
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#特殊形式" class="md-nav__link">
    特殊形式
  </a>
  
    <nav class="md-nav" aria-label="特殊形式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingtuple" class="md-nav__link">
    typing.Tuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingunion" class="md-nav__link">
    typing.Union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingoptional" class="md-nav__link">
    typing.Optional
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingcallable" class="md-nav__link">
    typing.Callable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingconcatenate" class="md-nav__link">
    typing.Concatenate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypegenericct_co" class="md-nav__link">
    class typing.Type(Generic[CT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingliteral" class="md-nav__link">
    typing.Literal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingclassvar" class="md-nav__link">
    typing.ClassVar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingfinal" class="md-nav__link">
    typing.Final
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingannotated" class="md-nav__link">
    typing.Annotated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtypeguard" class="md-nav__link">
    typing.TypeGuard
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#构建泛型类型" class="md-nav__link">
    构建泛型类型
  </a>
  
    <nav class="md-nav" aria-label="构建泛型类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typinggeneric" class="md-nav__link">
    class typing.Generic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypevar" class="md-nav__link">
    class typing.TypeVar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingparamspec" class="md-nav__link">
    class typing.ParamSpec
  </a>
  
    <nav class="md-nav" aria-label="class typing.ParamSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" class="md-nav__link">
    args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kwargs" class="md-nav__link">
    Kwargs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingparamspecargs" class="md-nav__link">
    typing.ParamSpecArgs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingparamspeckwargs" class="md-nav__link">
    typing.ParamSpecKwargs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typinganystr" class="md-nav__link">
    typing.AnyStr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingprotocolgeneric" class="md-nav__link">
    class typing.Protocol(Generic)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingruntime_checkable" class="md-nav__link">
    @typing.runtime_checkable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#其他特殊指令" class="md-nav__link">
    其他特殊指令
  </a>
  
    <nav class="md-nav" aria-label="其他特殊指令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingnamedtuple" class="md-nav__link">
    class typing.NamedTuple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingnewtypename-tp" class="md-nav__link">
    class typing.NewType(name, tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtypeddictdict" class="md-nav__link">
    class typing.TypedDict(dict)
  </a>
  
    <nav class="md-nav" aria-label="class typing.TypedDict(dict)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__total__" class="md-nav__link">
    __total__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#__required_keys__" class="md-nav__link">
    __required_keys__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#__optional_keys__" class="md-nav__link">
    __optional_keys__
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#泛型具象容器" class="md-nav__link">
    泛型具象容器
  </a>
  
    <nav class="md-nav" aria-label="泛型具象容器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#对应的内置类型" class="md-nav__link">
    对应的内置类型
  </a>
  
    <nav class="md-nav" aria-label="对应的内置类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingdictdict-mutablemappingkt-vt" class="md-nav__link">
    class typing.Dict(dict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinglistlist-mutablesequencet" class="md-nav__link">
    class typing.List(list, MutableSequence[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsetset-mutablesett" class="md-nav__link">
    class typing.Set(set, MutableSet[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingfrozensetfrozenset-abstractsett_co" class="md-nav__link">
    class typing.FrozenSet(frozenset, AbstractSet[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collections-对应类型" class="md-nav__link">
    collections 对应类型
  </a>
  
    <nav class="md-nav" aria-label="collections 对应类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingdefaultdictcollectionsdefaultdict-mutablemappingkt-vt" class="md-nav__link">
    class typing.DefaultDict(collections.defaultdict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingordereddictcollectionsordereddict-mutablemappingkt-vt" class="md-nav__link">
    class typing.OrderedDict(collections.OrderedDict, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingchainmapcollectionschainmap-mutablemappingkt-vt" class="md-nav__link">
    class typing.ChainMap(collections.ChainMap, MutableMapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcountercollectionscounter-dictt-int" class="md-nav__link">
    class typing.Counter(collections.Counter, Dict[T, int])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingdequedeque-mutablesequencet" class="md-nav__link">
    class typing.Deque(deque, MutableSequence[T])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#其他具象类型" class="md-nav__link">
    其他具象类型
  </a>
  
    <nav class="md-nav" aria-label="其他具象类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingio" class="md-nav__link">
    class typing.IO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtextio" class="md-nav__link">
    class typing.TextIO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calss-typingbinaryio" class="md-nav__link">
    calss typing.BinaryIO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingpattern" class="md-nav__link">
    class typing.Pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmatch" class="md-nav__link">
    class typing.Match
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingtext" class="md-nav__link">
    class typing.Text
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#抽象基类" class="md-nav__link">
    抽象基类
  </a>
  
    <nav class="md-nav" aria-label="抽象基类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collectionsabc-对应的容器" class="md-nav__link">
    collections.abc 对应的容器
  </a>
  
    <nav class="md-nav" aria-label="collections.abc 对应的容器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingabstractsetcollectiont_co" class="md-nav__link">
    class typing.AbstractSet(Collection[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingbytestringsequenceint" class="md-nav__link">
    class typing.ByteString(Sequence[int])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcollectionsized-iterablet_co-containert_co" class="md-nav__link">
    class typing.Collection(Sized, Iterable[T_co], Container[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingcontainergenerict_co" class="md-nav__link">
    class typing.Container(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingitemsviewmappingview-abstractsettuplekt_co-vt_co" class="md-nav__link">
    class typing.ItemsView(MappingView, AbstractSet[tuple[KT_co, VT_co]])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingkeysviewmappingview-abstractsetkt_co" class="md-nav__link">
    class typing.KeysView(MappingView, AbstractSet[KT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmappingcollectionkt-generickt-vt_co" class="md-nav__link">
    class typing.Mapping(Collection[KT], Generic[KT, VT_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmappingviewsized" class="md-nav__link">
    class typing.MappingView(Sized)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablemappingmappingkt-vt" class="md-nav__link">
    class typing.MutableMapping(Mapping[KT, VT])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablesequencesequencet" class="md-nav__link">
    class typing.MutableSequence(Sequence[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingmutablesetabstractsett" class="md-nav__link">
    class typing.MutableSet(AbstractSet[T])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsequencereversiblet_co-collectiont_co" class="md-nav__link">
    class typing.Sequence(Reversible[T_co], Collection[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingvaluesviewmappingview-collection_vt_co" class="md-nav__link">
    class typing.ValuesView(MappingView, Collection[_VT_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collectionsabc-对应的其他类型" class="md-nav__link">
    collections.abc 对应的其他类型
  </a>
  
    <nav class="md-nav" aria-label="collections.abc 对应的其他类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingiterablegenerict_co" class="md-nav__link">
    class typing.Iterable(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingiteratoriterablet_co" class="md-nav__link">
    class typing.Iterator(Iterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinggeneratoriteratort_co-generict_co-t_contra-v_co" class="md-nav__link">
    class typing.Generator(Iterator[T_co], Generic[T_co, T_contra, V_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typinghashable" class="md-nav__link">
    class typing.Hashable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingreversibleiterablet_co" class="md-nav__link">
    class typing.Reversible(Iterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingsized" class="md-nav__link">
    class typing.Sized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#异步编程" class="md-nav__link">
    异步编程
  </a>
  
    <nav class="md-nav" aria-label="异步编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingcoroutineawaitablev_co-generict_co-t_contra-v_co" class="md-nav__link">
    class typing.Coroutine(Awaitable[V_co], Generic[T_co, T_contra, V_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasyncgeneratorasynciteratort_co-generict_co-t_contra" class="md-nav__link">
    class typing.AsyncGenerator(AsyncIterator[T_co], Generic[T_co, T_contra])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynciterablegenerict_co" class="md-nav__link">
    class typing.AsyncIterable(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynciteratorasynciterablet_co" class="md-nav__link">
    class typing.AsyncIterator(AsyncIterable[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingawaitablegenerict_co" class="md-nav__link">
    class typing.Awaitable(Generic[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#上下文管理器类型" class="md-nav__link">
    上下文管理器类型
  </a>
  
    <nav class="md-nav" aria-label="上下文管理器类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-typingcontextmanagergenerict_co" class="md-nav__link">
    class typing.ContextManager(Generic[T_co])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingasynccontextmanagergenerict_co" class="md-nav__link">
    class typing.AsyncContextManager(Generic[T_co])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#协议" class="md-nav__link">
    协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#函数与装饰器" class="md-nav__link">
    函数与装饰器
  </a>
  
    <nav class="md-nav" aria-label="函数与装饰器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingcasttyp-val" class="md-nav__link">
    typing.cast(typ, val)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingoverload" class="md-nav__link">
    @typing.overload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingfinal_1" class="md-nav__link">
    @typing.final
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingno_type_check" class="md-nav__link">
    @typing.no_type_check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingno_type_check_decorator" class="md-nav__link">
    @typing.no_type_check_decorator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingtype_check_only" class="md-nav__link">
    @typing.type_check_only
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#内省辅助器" class="md-nav__link">
    内省辅助器
  </a>
  
    <nav class="md-nav" aria-label="内省辅助器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingget_type_hintsobj-globalnsnone-localnsnone-include_extrasfalse" class="md-nav__link">
    typing.get_type_hints(obj, globalns=None, localns=None, include_extras=False)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingget_argstp" class="md-nav__link">
    typing.get_args(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingget_origintp" class="md-nav__link">
    typing.get_origin(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typingis_typeddicttp" class="md-nav__link">
    typing.is_typeddict(tp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-typingforwardref" class="md-nav__link">
    class typing.ForwardRef
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#常量" class="md-nav__link">
    常量
  </a>
  
    <nav class="md-nav" aria-label="常量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typingtype_checking" class="md-nav__link">
    typing.TYPE_CHECKING
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="类型标注">类型标注<a class="headerlink" href="#类型标注" title="Permanent link">&para;</a></h1>
<p>参考原文: <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#special-typing-primitives" target="_blank">https://docs.python.org/zh-cn/3.10/library/typing.html#special-typing-primitives</a></p>
<p>3.5 新版功能.</p>
<p>源码： <a href="https://github.com/python/cpython/tree/3.10/Lib/typing.py" target="_blank">Lib/typing.py</a></p>
<blockquote>
<p><strong>注解</strong>: Python 运行时不强制执行函数和变量类型注解，但这些注解可用于类型检查器、IDE、静态检查器等第三方工具。</p>
</blockquote>
<p>这个模块提供对类型提示的运行时支持。最基本的支持包括 <a href="#typingany">Any</a> , <a href="#typingunion">Union</a> , <a href="#typingcallable">Callable</a> , <a href="#typingtypevar">TypeVar</a> , 和 <a href="#class-typinggeneric">Generic</a> 。关于完整的规范，请参考 <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> 。关于类型提示的简化介绍，请参考 <a href="https://www.python.org/dev/peps/pep-0483">PEP 483</a> 。</p>
<p>下面的函数接收与返回的都是字符串，注解方式如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">greeting</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s1">&#39;Hello &#39;</span> <span class="o">+</span> <span class="n">name</span>
</code></pre></div>
<p><code>greeting</code> 函数中，参数 <code>name</code> 的类型是 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#str">str</a>，返回类型也是 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#str">str</a>。子类型也可以当作参数。</p>
<p>新的功能频繁地被添加到 <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#module-typing">typing</a> 模块中。<a href="https://pypi.org/project/typing-extensions/">typing_extensions</a> 包提供了这些新功能对旧版本 Python 的向后移植。</p>
<h2 id="相关的-pep">相关的 PEP<a class="headerlink" href="#相关的-pep" title="Permanent link">&para;</a></h2>
<p>参考: <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#relevant-peps" target="_blank">https://docs.python.org/zh-cn/3.10/library/typing.html#relevant-peps</a></p>
<h2 id="类型别名">类型别名<a class="headerlink" href="#类型别名" title="Permanent link">&para;</a></h2>
<p>把类型赋给别名，就可以定义类型别名。本例中，<code>Vector</code> 和 <code>list[float]</code> 相同，可互换：</p>
<div class="highlight"><pre><span></span><code><span class="n">Vector</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">scalar</span> <span class="o">*</span> <span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">]</span>

<span class="c1"># passes type checking; a list of floats qualifies as a Vector.</span>
<span class="c1"># 通过类型检查； 浮点数列表可以作为Vector。</span>
<span class="n">new_vector</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">])</span>
</code></pre></div>
<p>类型别名适用于简化复杂的类型签名。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>

<span class="n">ConnectionOptions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">Address</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">Server</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Address</span><span class="p">,</span> <span class="n">ConnectionOptions</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">broadcast_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">servers</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Server</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># The static type checker will treat the previous type signature as</span>
<span class="c1"># being exactly equivalent to this one.</span>
<span class="c1"># 静态类型检查器会将前一个类型签名视为与当前类型签名完全等同。</span>
<span class="k">def</span> <span class="nf">broadcast_message</span><span class="p">(</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">servers</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<p>注意，<code>None</code> 是一种类型提示特例，已被 <code>type(None)</code> 取代。</p>
<h2 id="newtype">NewType<a class="headerlink" href="#newtype" title="Permanent link">&para;</a></h2>
<p>使用 <a href="#newtype">NewType</a> 助手来创建不同的类型</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NewType</span>

<span class="n">UserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;UserId&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">some_id</span> <span class="o">=</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">524313</span><span class="p">)</span>
</code></pre></div>
<p>静态类型检查器把新类型当作原始类型的子类，这种方式适用于捕捉逻辑错误：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_user_name</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="n">UserId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># passes type checking</span>
<span class="n">user_a</span> <span class="o">=</span> <span class="n">get_user_name</span><span class="p">(</span><span class="n">UserId</span><span class="p">(</span><span class="mi">42351</span><span class="p">))</span>

<span class="c1"># fails type checking; an int is not a UserId</span>
<span class="n">user_b</span> <span class="o">=</span> <span class="n">get_user_name</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><code>UserId</code> 类型的变量可执行所有 <code>int</code> 操作，但返回结果都是 <code>int</code> 类型。这种方式允许在预期 <code>int</code> 时传入 <code>UserId</code>，还能防止意外创建无效的 <code>UserId</code>：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># &#39;output&#39; is of type &#39;int&#39;, not &#39;UserId&#39;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">23413</span><span class="p">)</span> <span class="o">+</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">54341</span><span class="p">)</span>
</code></pre></div>
<p>注意，这些检查只由静态类型检查器强制执行。在运行时，语句 <code>Derived = NewType('Derived', Base)</code> 将产生一个 <code>Derived</code> 可调用对象，该对象立即返回你传递给它的任何参数。 这意味着语句 <code>Derived(some_value)</code> 不会创建一个新的类，也不会引入超出常规函数调用的很多开销。</p>
<p>更确切地说，在运行时，<code>some_value is Derived(some_value)</code> 表达式总为<code>True</code>。</p>
<p>创建 <code>Derived</code> 的子类型是无效的:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NewType</span>

<span class="n">UserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;UserId&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

<span class="c1"># Fails at runtime and does not pass type checking</span>
<span class="k">class</span> <span class="nc">AdminUserId</span><span class="p">(</span><span class="n">UserId</span><span class="p">):</span> <span class="k">pass</span>
</code></pre></div>
<p>然而，我们可以在 "派生的" <code>NewType</code> 的基础上创建一个 <a href="#newtype">NewType</a>。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NewType</span>

<span class="n">UserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;UserId&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

<span class="n">ProUserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;ProUserId&#39;</span><span class="p">,</span> <span class="n">UserId</span><span class="p">)</span>
</code></pre></div>
<p>同时，<code>ProUserId</code> 的类型检查也可以按预期执行。 详见 <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a>。</p>
<blockquote>
<p><strong>注解</strong>: 回顾上文，类型别名声明了两种彼此 <em>等价</em> 的类型。 <code>Alias = Original</code> 时，静态类型检查器认为 <code>Alias</code> 与 <code>Original</code> 完全等价。 这种方式适用于简化复杂类型签名。</p>
<p>反之，<code>NewType</code> 声明把一种类型当作另一种类型的 <em>子类型</em>。<code>Derived = NewType('Derived', Original)</code> 时，静态类型检查器把 <code>Derived</code> 当作 <code>Original</code> 的 子类 <code>，即，Original</code> 类型的值不能用在预期 <code>Derived</code> 类型的位置。这种方式适用于以最小运行时成本防止逻辑错误。</p>
</blockquote>
<p><em>3.5.2 新版功能.</em></p>
<p>在 <em>3.10 版更改</em>: <code>NewType</code> 现在是一个类而不是一个函数。 在调用 <code>NewType</code> 而不是普通的函数时，会有一些额外的运行时间成本。 然而，这种开销将在 <code>3.11.0</code> 中减少。</p>
<h2 id="可调对象callable">可调对象（Callable）<a class="headerlink" href="#可调对象callable" title="Permanent link">&para;</a></h2>
<p>预期特定签名回调函数的框架可以用 <code>Callable[[Arg1Type, Arg2Type], ReturnType]</code> 实现类型提示。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span>

<span class="k">def</span> <span class="nf">feeder</span><span class="p">(</span><span class="n">get_next_item</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Body</span>

<span class="k">def</span> <span class="nf">async_query</span><span class="p">(</span><span class="n">on_success</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
                <span class="n">on_error</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Body</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">on_update</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Body</span>

<span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">on_update</span>
</code></pre></div>
<p>无需指定调用签名，用省略号字面量替换类型提示里的参数列表： <code>Callable[..., ReturnType]</code>，就可以声明可调对象的返回类型。</p>
<p>以其他可调用对象为参数的可调用对象可以使用 <a href="#typingparamspec">ParamSpec</a> 来表明其参数类型是相互依赖的。此外，如果该可调用对象增加或删除了其他可调用对象的参数，可以使用 <a href="#typingconcatenate">Concatenate</a> 操作符。 它们分别采取<code>Callable[ParamSpecVariable, ReturnType]</code> 和 <code>Callable[Concatenate[Arg1Type, Arg2Type, ..., ParamSpecVariable], ReturnType]</code> 的形式。</p>
<p>在 3.10 版更改: <code>Callable</code> now supports <a href="#typingparamspec">ParamSpec</a> and <a href="#typingconcatenate">Concatenate</a>. See <a href="https://www.python.org/dev/peps/pep-0612">PEP 612</a> for more details.</p>
<h2 id="泛型generic">泛型（Generic）<a class="headerlink" href="#泛型generic" title="Permanent link">&para;</a></h2>
<p>容器中，对象的类型信息不能以泛型方式静态推断，因此，抽象基类扩展支持下标，用于表示容器元素的预期类型。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="k">def</span> <span class="nf">notify_by_email</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Employee</span><span class="p">],</span>
                    <span class="n">overrides</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div>
<p><a href="https://docs.python.org/zh-cn/3.10/library/typing.html#module-typing">typing</a> 模块中推出的 <a href="#typingtypevar">TypeVar</a> 工厂函数实现泛型参数化。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>      <span class="c1"># Declare type variable</span>

<span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>   <span class="c1"># Generic function</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
<h2 id="用户定义的泛型类型">用户定义的泛型类型<a class="headerlink" href="#用户定义的泛型类型" title="Permanent link">&para;</a></h2>
<p>用户定义的类可以定义为泛型类。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">Logger</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">LoggedVar</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">Logger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Set &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Get &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div>
<p><code>Generic[T]</code> 是定义类 <code>LoggedVar</code> 的基类，该类使用单类型参数 <code>T</code>。在该类体内，<code>T</code> 是有效的类型。</p>
<p><a href="#class-typinggeneric">Generic</a> 基类定义了 [<strong>class_getitem</strong>()] 所以 <code>LoggedVar[T]</code> 可以作为一个有效的类型注释：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>

<span class="k">def</span> <span class="nf">zero_all_vars</span><span class="p">(</span><span class="nb">vars</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">LoggedVar</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
        <span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>一个泛型可以有任何数量的类型变量。所有种类的 <a href="#typingtypevar">TypeVar</a> 都可以作为泛型的参数:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">contravariant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span> <span class="n">covariant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">WeirdTrio</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">]):</span>
    <span class="o">...</span>
</code></pre></div>
<p><a href="#class-typinggeneric">Generic</a> <mark class="critic">类型变量的参数应各不相同</mark>。下列代码就是无效的：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span>
<span class="o">...</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Pair</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">]):</span>   <span class="c1"># INVALID</span>
    <span class="o">...</span>
</code></pre></div>
<p><a href="#class-typinggeneric">Generic</a> 支持多重继承：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sized</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Generic</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">LinkedList</span><span class="p">(</span><span class="n">Sized</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="o">...</span>
</code></pre></div>
<p>继承自泛型类时，可以修正某些类型变量：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Mapping</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyDict</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]):</span>
    <span class="o">...</span>
</code></pre></div>
<p>比如，本例中 <code>MyDict</code> 调用的单参数，<code>T</code>。</p>
<p>未指定泛型类的类型参数时，每个位置的类型都预设为 <a href="#typingany">Any</a>。下例中，<code>MyIterable</code> 不是泛型，但却隐式继承了 <code>Iterable[Any]</code>：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>

<span class="k">class</span> <span class="nc">MyIterable</span><span class="p">(</span><span class="n">Iterable</span><span class="p">):</span> <span class="c1"># Same as Iterable[Any]</span>
</code></pre></div>
<p>还支持用户定义的泛型类型别名。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
<span class="n">Response</span> <span class="o">=</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span>

<span class="c1"># Return type here is same as Iterable[str] | int</span>
<span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="o">...</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>
<span class="n">Vec</span> <span class="o">=</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">inproduct</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Vec</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span> <span class="c1"># Same as Iterable[tuple[T, T]]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">v</span><span class="p">)</span>
</code></pre></div>
<p>在 3.7 版更改: <a href="#class-typinggeneric">Generic</a> 不再支持自定义元类。</p>
<p>用户定义的参数表达式的泛型也通过 <code>Generic[P]</code> 形式的参数规范变量来支持。该行为与上面描述的类型变量一致，因为参数规范变量被类型化模块视为一个专门的类型变量。 这方面的一个例外是，一个类型列表可以用来替代 <a href="#typingparamspec">ParamSpec</a>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">ParamSpec</span><span class="p">,</span> <span class="n">TypeVar</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">]):</span> <span class="o">...</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Z</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
<span class="n">__main__</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">dict</span><span class="s1">&#39;&gt;, &lt;class &#39;</span><span class="nb">float</span><span class="s1">&#39;&gt;)]</span>
</code></pre></div>
<p>此外，一个只有一个参数规范变量的泛型将接受表格 <code>X[[Type1, Type2, ...]]</code> 中的参数列表，出于美观的考虑也包括 <code>X[Type1, Type2, ...]</code> 。 在内部，后者被转换为前者，所以下面的内容是等价的:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">P</span><span class="p">]):</span> <span class="o">...</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">__main__</span><span class="o">.</span><span class="n">X</span><span class="p">[(</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">int</span><span class="s1">&#39;&gt;, &lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">X</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
<span class="n">__main__</span><span class="o">.</span><span class="n">X</span><span class="p">[(</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">int</span><span class="s1">&#39;&gt;, &lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;)]</span>
</code></pre></div>
<p>请注意，带有 <a href="#typingparamspec">ParamSpec</a> 的泛型在某些情况下可能不会有正确的<code>__parameters__</code>，因为它们主要用于静态类型检查。</p>
<p>在 3.10 版更改: <a href="#class-typinggeneric">Generic</a> 现在可以通过参数表达式进行参数化。参见 <a href="#typingparamspec">ParamSpec</a> 和 <a href="https://www.python.org/dev/peps/pep-0612">PEP 612</a> 以了解更多细节。</p>
<p>用户定义的泛型类可以将 <code>ABC</code> 作为基类，而不会发生元类冲突。 不支持通用元类。 参数化泛型的结果被缓存，并且类型模块中的大多数类型都是<a href="https://docs.python.org/zh-cn/3.10/glossary.html#term-hashable">可散列</a>的并且可以比较相等性。</p>
<h2 id="any-类型">Any 类型<a class="headerlink" href="#any-类型" title="Permanent link">&para;</a></h2>
<p><a href="#typingany">Any</a> 是一种特殊的类型。静态类型检查器认为所有类型均与 <a href="#typingany">Any</a> 兼容，同样，<a href="#typingany">Any</a> 也与所有类型兼容。</p>
<p>也就是说，可对 <a href="#typingany">Any</a> 类型的值执行任何操作或方法调用，并赋值给任意变量：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="n">a</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>          <span class="c1"># OK</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>           <span class="c1"># OK</span>

<span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">a</span>           <span class="c1"># OK</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Passes type checking; &#39;item&#39; could be any type,</span>
    <span class="c1"># and that type might have a &#39;bar&#39; method</span>
    <span class="n">item</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
    <span class="o">...</span>
</code></pre></div>
<p>请注意，将 <a href="#typingany">Any</a> 类型的值分配给更精确的类型时，不会执行类型检查。 例如，静态类型检查器在将 <code>a</code> 分配给 <code>s</code> 时没有报告错误，即使 <code>s</code> 被声明为 <code>str</code> 类型并在运行时接收 <code>int</code> 值！</p>
<p>此外，未指定返回值与参数类型的函数，都隐式地默认使用 <a href="#typingany">Any</a>：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">legacy_parser</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># A static type checker will treat the above</span>
<span class="c1"># as having the same signature as:</span>
<span class="k">def</span> <span class="nf">legacy_parser</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>
<p>需要混用动态与静态类型代码时，此操作把 <a href="#typingany">Any</a> 当作 <em>应急出口</em>。</p>
<p><a href="#typingany">Any</a> 和 <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a> 的区别。与 <a href="#typingany">Any</a> 相似，所有类型都是 <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a> 的子类型。然而，与 <a href="#typingany">Any</a> 不同，<a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a> 不可逆：<a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a> <em>不是</em> 其它类型的子类型。</p>
<p>就是说，值的类型是 <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a> 时，类型检查器几乎会拒绝所有对它的操作，并且，把它赋给更精确的类型变量（或返回值）属于类型错误。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hash_a</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Fails type checking; an object does not have a &#39;magic&#39; method.</span>
    <span class="c1"># 类型检查失败； 任何obje对象都没有“magic”方法。</span>
    <span class="n">item</span><span class="o">.</span><span class="n">magic</span><span class="p">()</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">hash_b</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Passes type checking</span>
    <span class="c1"># 通过类型检查</span>
    <span class="n">item</span><span class="o">.</span><span class="n">magic</span><span class="p">()</span>
    <span class="o">...</span>

<span class="c1"># Passes type checking, since ints and strs are subclasses of object</span>
<span class="c1"># 通过类型检查，因为 int 和 str 是object的子类</span>
<span class="n">hash_a</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">hash_a</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>

<span class="c1"># Passes type checking, since Any is compatible with all types</span>
<span class="c1"># 通过类型检查，因为 Any 与所有类型兼容</span>
<span class="n">hash_b</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">hash_b</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</code></pre></div>
<p><mark class="critic"><strong>使用 <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#object">object</a>，说明值能以类型安全的方式转为任何类型。使用 <a href="#typingany">Any</a>，说明值是动态类型。</strong></mark></p>
<h2 id="名义子类型-vs-结构子类型">名义子类型 vs 结构子类型<a class="headerlink" href="#名义子类型-vs-结构子类型" title="Permanent link">&para;</a></h2>
<p>最初 <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> 将 Python 静态类型系统定义为使用 <em>名义子类型</em>。这意味着当且仅当类 <code>A</code> 是 <code>B</code> 的子类时，才满足有类 <code>B</code> 预期时使用类 <code>A</code> 。</p>
<p>此项要求以前也适用于抽象基类，例如，<a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterable">Iterable</a> 。这种方式的问题在于，定义类时必须显式说明，既不 Pythonic，也不是动态类型式 Python 代码的惯用写法。例如，下列代码就遵从了 <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> 的规范：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sized</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Iterator</span>

<span class="k">class</span> <span class="nc">Bucket</span><span class="p">(</span><span class="n">Sized</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span> <span class="o">...</span>
</code></pre></div>
<p><a href="https://www.python.org/dev/peps/pep-0544">PEP 544</a> 允许用户在类定义时不显式说明基类，从而解决了这一问题，静态类型检查器隐式认为 <code>Bucket</code> 既是 <code>Sized</code> 的子类型，又是 <code>Iterable[int]</code> 的子类型。这就是 <em>结构子类型</em> （又称为静态鸭子类型）：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Iterable</span>

<span class="k">class</span> <span class="nc">Bucket</span><span class="p">:</span>  <span class="c1"># Note: 没有基类</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span> <span class="o">...</span>

<span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">Bucket</span><span class="p">())</span>  <span class="c1"># 通过类型检查</span>
</code></pre></div>
<p>此外，结构子类型的优势在于，通过继承特殊类 [Protocol] ，用户可以定义新的自定义协议（见下文中的例子）。</p>
<h2 id="模块内容">模块内容<a class="headerlink" href="#模块内容" title="Permanent link">&para;</a></h2>
<p>本模块定义了下列类、函数和修饰器。</p>
<blockquote>
<p><strong>注解</strong>: 本模块定义了一些类型，作为标准库中已有的类的子类，从而可以让 <a href="#class-typinggeneric">Generic</a> 支持 [] 中的类型变量。Python 3.9 中，这些标准库的类已支持 <code>[]</code> ，因此，这些类型就变得冗余了。</p>
<p>Python 3.9 弃用了这些冗余类型，但解释器并未提供相应的弃用警告。标记弃用类型的工作留待支持 Python 3.9 及以上版本的类型检查器实现。</p>
<p>Python 3.9.0 发布五年后的首个 Python 发行版将从 <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#module-typing">typing</a> 模块中移除这些弃用类型。详见 <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> 《标准集合的类型提示泛型》。</p>
</blockquote>
<h3 id="特殊类型原语">特殊类型原语<a class="headerlink" href="#特殊类型原语" title="Permanent link">&para;</a></h3>
<h4 id="特殊类型">特殊类型<a class="headerlink" href="#特殊类型" title="Permanent link">&para;</a></h4>
<p><ins class="critic">这些类型可用于类型注解，但不支持 <code>[]</code>。</ins></p>
<h5 id="typingany">typing.Any<a class="headerlink" href="#typingany" title="Permanent link">&para;</a></h5>
<p>不受限的特殊类型。</p>
<ul>
<li>所有类型都与 <a href="#typingany">Any</a> 兼容。</li>
<li><a href="#typingany">Any</a> 与所有类型都兼容。</li>
</ul>
<h5 id="typingnoreturn">typing.NoReturn<a class="headerlink" href="#typingnoreturn" title="Permanent link">&para;</a></h5>
<p>标记没有返回值的函数的特殊类型。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NoReturn</span>

<span class="k">def</span> <span class="nf">stop</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NoReturn</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;no way&#39;</span><span class="p">)</span>
</code></pre></div>
<h5 id="typingtypealias">typing.TypeAlias<a class="headerlink" href="#typingtypealias" title="Permanent link">&para;</a></h5>
<p>用于显式声明 <a href="#_2">类型别名</a> 的特殊标注。 例如:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeAlias</span>

<span class="n">Factors</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>
<p>关于显式类型别名的更多细节，请参见 <a href="https://www.python.org/dev/peps/pep-0613">PEP 613</a>。</p>
<h4 id="特殊形式">特殊形式<a class="headerlink" href="#特殊形式" title="Permanent link">&para;</a></h4>
<p><mark class="critic">可用于类型注解，且支持 <code>[]</code> ，每种形式都有其独特的句法。</mark></p>
<h5 id="typingtuple">typing.Tuple<a class="headerlink" href="#typingtuple" title="Permanent link">&para;</a></h5>
<p>元组类型； <code>Tuple[X, Y]</code> 是二项元组类型，第一个元素的类型是 <code>X</code>，第二个元素的类型是 <code>Y</code>。空元组的类型可写为 <code>Tuple[()]</code>。</p>
<p>例：<code>Tuple[T1, T2]</code> 是二项元组，类型变量分别为 <code>T1</code> 和 <code>T2</code>。<code>Tuple[int, float, str]</code> 是由整数、浮点数、字符串组成的三项元组。</p>
<p>可用省略号字面量指定同质变长元组，例如，<code>Tuple[int, ...]</code> 。<code>Tuple</code> 与 <code>Tuple[Any, ...]</code> 等价，也与 <code>tuple</code> 等价。</p>
<h5 id="typingunion">typing.Union<a class="headerlink" href="#typingunion" title="Permanent link">&para;</a></h5>
<p>联合类型； <code>Union[X, Y]</code> 等价于 <code>X | Y</code> ，意味着满足 <code>X</code> 或 <code>Y</code> 之一。</p>
<p>要定义一个联合类型，可以使用类似 <code>Union[int, str]</code> 或简写 <code>int | str</code>。建议使用这种简写。细节:</p>
<ul>
<li>参数必须是某种类型，且至少有一个。</li>
<li>
<p>联合类型之联合类型会被展平，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">Union</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">==</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p>单参数之联合类型就是该参数自身，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span>  <span class="c1"># The constructor actually returns int</span>
</code></pre></div>
</li>
<li>
<p>冗余的参数会被跳过，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">==</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span>
</code></pre></div>
</li>
<li>
<p>比较联合类型，不涉及参数顺序，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">==</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><code>Union</code> 不能作为子类，也不能实例化。</p>
</li>
<li>不支持 <code>Union[X][Y]</code> 这种写法。</li>
</ul>
<p>在 3.7 版更改: 在运行时，不要移除联合类型中的显式子类。</p>
<p>在 3.10 版更改: 联合类型现在可以写成 <code>X | Y</code>。 参见 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-union">联合类型表达式</a>。</p>
<h5 id="typingoptional">typing.Optional<a class="headerlink" href="#typingoptional" title="Permanent link">&para;</a></h5>
<p>可选类型。</p>
<p><code>Optional[X]</code> 等价于 <code>X | None</code> （或 <code>Union[X, None]</code> ） 。</p>
<p>注意，可选类型与含默认值的可选参数不同。含默认值的可选参数不需要在类型注解上添加 <code>Optional</code> 限定符，因为它仅是可选的。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<p>另一方面，显式应用 <code>None</code> 值时，不管该参数是否可选， <code>Optional</code> 都适用。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<p>在 3.10 版更改: 可选参数现在可以写成 <code>X | None</code>。 参见 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-union">联合类型表达式</a>。</p>
<h5 id="typingcallable">typing.Callable<a class="headerlink" href="#typingcallable" title="Permanent link">&para;</a></h5>
<p>可调类型； <code>Callable[[int], str]</code> 是把<code>（int）</code>转为 <code>str</code> 的函数。</p>
<p>下标句法必须与参数列表和返回类型这两个值一起使用。参数列表只能是类型列表或省略号；返回类型只能是单一类型。</p>
<p>没有说明可选参数或关键字参数的句法；这类函数类型很少用作回调类型。<code>Callable[..., ReturnType]</code> （省略号字面量）可用于为接受任意数量参数，并返回 <code>ReturnType</code> 的可调对象提供类型提示。
纯 <a href="#typingcallable">Callable</a> 等价于 <code>Callable[..., Any]</code>，进而等价于 <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Callable">collections.abc.Callable</a> 。</p>
<p>以其他可调用对象为参数的可调用对象可以使用 <a href="#typingparamspec">ParamSpec</a> 来表明其参数类型是相互依赖的。此外，如果该可调用对象增加或删除了其他可调用对象的参数，可以使用 <a href="#typingconcatenate">Concatenate</a> 操作符。 它们分别采取<code>Callable[ParamSpecVariable, ReturnType]</code> 和 <code>Callable[Concatenate[Arg1Type, Arg2Type, ..., ParamSpecVariable], ReturnType]</code> 的形式。</p>
<p>3.9 版后已移除: <code>collections.abc.Callable</code> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<p>在 3.10 版更改: <code>Callable</code> now supports <a href="#typingparamspec">ParamSpec</a> and <a href="#typingconcatenate">Concatenate</a>. See <a href="https://www.python.org/dev/peps/pep-0612">PEP 612</a> for more details.</p>
<blockquote>
<p><strong>参见</strong> <a href="#typingparamspec">ParamSpec</a> 和 <a href="#typingconcatenate">Concatenate</a> 的文档提供了使用 <code>Callable</code> 的例子。</p>
</blockquote>
<h5 id="typingconcatenate">typing.Concatenate<a class="headerlink" href="#typingconcatenate" title="Permanent link">&para;</a></h5>
<p>与 <a href="#typingcallable">Callable</a> 和 <a href="#typingparamspec">ParamSpec</a> 一起使用，对一个高阶可调用对象进行类型注释，该对象可以增加、删除或转换另一个可调用对象的参数。 使用形式为<code>Concatenate[Arg1Type, Arg2Type, ..., ParamSpecVariable]</code>。 <code>Concatenate</code> 目前只在作为 <a href="#typingcallable">Callable</a> 的第一个参数时有效。Concatenate` 的最后一个参数必须是一个 <a href="#typingparamspec">ParamSpec</a>。</p>
<p>例如，为了注释一个装饰器 <code>with_lock</code>，它为被装饰的函数提供了 <a href="https://docs.python.org/zh-cn/3.10/library/threading.html#threading.Lock">threading.Lock</a>，<code>Concatenate</code> 可以用来表示 <code>with_lock</code> 期望一个可调用对象，该对象接收一个 <code>Lock</code> 作为第一个参数，并返回一个具有不同类型签名的可调用对象。 在这种情况下，<a href="#typingparamspec">ParamSpec</a> 表示返回的可调用对象的参数类型取决于被传入的可调用程序的参数类型:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Lock</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Concatenate</span><span class="p">,</span> <span class="n">ParamSpec</span><span class="p">,</span> <span class="n">TypeVar</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>

<span class="c1"># Use this lock to ensure that only one thread is executing a function</span>
<span class="c1"># at any time.</span>
<span class="c1"># 使用这个锁可以保证任何时候只有一个线程在执行一个函数。</span>
<span class="n">my_lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">with_lock</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Lock</span><span class="p">,</span> <span class="n">P</span><span class="p">],</span> <span class="n">R</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">R</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;A type-safe decorator which provides a lock.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="p">:</span>
        <span class="c1"># Provide the lock as the first argument.</span>
        <span class="c1"># 提供锁的类型安全装饰器。</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">my_lock</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inner</span>

<span class="nd">@with_lock</span>
<span class="k">def</span> <span class="nf">sum_threadsafe</span><span class="p">(</span><span class="n">lock</span><span class="p">:</span> <span class="n">Lock</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Add a list of numbers together in a thread-safe manner.&#39;&#39;&#39;</span>
    <span class="c1"># 以线程安全的方式将数字列表加在一起。</span>
    <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>

<span class="c1"># We don&#39;t need to pass in the lock ourselves thanks to the decorator.</span>
<span class="c1"># 多亏了装饰器，我们不需要自己传入锁。</span>
<span class="n">sum_threadsafe</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">])</span>
</code></pre></div>
<p>3.10 新版功能.</p>
<blockquote>
<p><strong>参见</strong>:</p>
<ul>
<li><a href="https://www.python.org/dev/peps/pep-0612">PEP 612</a> -- 参数规范变量（引入 <code>ParamSpec</code> 和 <code>Concatenate</code> 的 PEP）。</li>
<li><a href="#typingparamspec">ParamSpec</a> 和 <a href="#typingcallable">Callable</a>。</li>
</ul>
</blockquote>
<h5 id="class-typingtypegenericct_co">class typing.Type(Generic[CT_co])<a class="headerlink" href="#class-typingtypegenericct_co" title="Permanent link">&para;</a></h5>
<p>用 <code>C</code> 注解的变量可以接受类型 <code>C</code> 的值。反之，用 <code>Type[C]</code> 注解的变量可以接受类自身的值 — 准确地说，是接受 <code>C</code> 的 <em>类对象</em>，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>         <span class="c1"># Has type &#39;int&#39;</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">int</span>       <span class="c1"># Has type &#39;Type[int]&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="c1"># Also has type &#39;Type[int]&#39;</span>
</code></pre></div>
<p>注意，<code>Type[C]</code> 为协变量：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">User</span><span class="p">:</span> <span class="o">...</span>
<span class="k">class</span> <span class="nc">BasicUser</span><span class="p">(</span><span class="n">User</span><span class="p">):</span> <span class="o">...</span>
<span class="k">class</span> <span class="nc">ProUser</span><span class="p">(</span><span class="n">User</span><span class="p">):</span> <span class="o">...</span>
<span class="k">class</span> <span class="nc">TeamUser</span><span class="p">(</span><span class="n">User</span><span class="p">):</span> <span class="o">...</span>

<span class="c1"># Accepts User, BasicUser, ProUser, TeamUser, ...</span>
<span class="k">def</span> <span class="nf">make_new_user</span><span class="p">(</span><span class="n">user_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">User</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="k">return</span> <span class="n">user_class</span><span class="p">()</span>
</code></pre></div>
<p><code>Type[C]</code> 为协变量的意思是指， <code>C</code> 的所有子类都应使用与 <code>C</code> 相同的构造器签名及类方法签名。类型检查器应标记违反此项规定的内容，但也应允许符合指定基类构造器调用的子类进行构造器调用。<a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> 修订版将来可能会调整类型检查器对这种特例的处理方式。</p>
<p><code>Type</code> 合法的参数仅有类、<code>Any</code> 、<a href="#generic">类型变量</a> 以及上述类型的联合类型。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">new_non_team_user</span><span class="p">(</span><span class="n">user_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">BasicUser</span> <span class="o">|</span> <span class="n">ProUser</span><span class="p">]):</span> <span class="o">...</span>
</code></pre></div>
<p><code>Type[Any]</code> 等价于 <code>Type</code>，进而等价于 Python 元类架构的根基，<code>type</code>。</p>
<p>3.5.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#type">builtins.type</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="typingliteral">typing.Literal<a class="headerlink" href="#typingliteral" title="Permanent link">&para;</a></h5>
<p>表示类型检查器对应变量或函数参数的值等价于给定字面量（或多个字面量之一）的类型。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_simple</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]:</span>  <span class="c1"># always returns True</span>
    <span class="o">...</span>

<span class="n">MODE</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">open_helper</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">MODE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">open_helper</span><span class="p">(</span><span class="s1">&#39;/some/path&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>  <span class="c1"># Passes type check</span>
<span class="n">open_helper</span><span class="p">(</span><span class="s1">&#39;/other/path&#39;</span><span class="p">,</span> <span class="s1">&#39;typo&#39;</span><span class="p">)</span>  <span class="c1"># Error in type checker</span>
</code></pre></div>
<p><code>Literal[...]</code> 不能创建子类。在运行时，任意值均可作为 <code>Literal[...]</code> 的类型参数，但类型检查器可以对此加以限制。字面量类型详见 [PEP 586] 。</p>
<p>3.8 新版功能.</p>
<p>在 3.9.1 版更改: <code>Literal</code> 现在能去除形参的重复。 <code>Literal</code> 对象的相等性比较不再依赖顺序。 现在如果有某个参数不为 <a href="https://docs.python.org/zh-cn/3.10/glossary.html#term-hashable">hashable</a>，<code>Literal</code> 对象在相等性比较期间将引发 <a href="https://docs.python.org/zh-cn/3.10/library/exceptions.html#TypeError">TypeError</a>。</p>
<h5 id="typingclassvar">typing.ClassVar<a class="headerlink" href="#typingclassvar" title="Permanent link">&para;</a></h5>
<p>标记类变量的特殊类型构造器。</p>
<p>如 <a href="https://www.python.org/dev/peps/pep-0526">PEP 526</a> 所述，打包在 <code>ClassVar</code> 内的变量注解是指，给定属性应当用作类变量，而不应设置在类实例上。用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Starship</span><span class="p">:</span>
    <span class="n">stats</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># class variable</span>
    <span class="n">damage</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>                     <span class="c1"># instance variable</span>
</code></pre></div>
<p>[ClassVar] 仅接受类型，也不能使用下标。</p>
<p>[ClassVar] 本身不是类，不应用于 [isinstance()] 或 [issubclass()]。[ClassVar] 不改变 Python 运行时行为，但可以用于第三方类型检查器。例如，类型检查器会认为以下代码有错：</p>
<div class="highlight"><pre><span></span><code><span class="n">enterprise_d</span> <span class="o">=</span> <span class="n">Starship</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">enterprise_d</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Error, setting class variable on instance</span>
<span class="n">Starship</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1"># This is OK</span>
</code></pre></div>
<p>3.5.3 新版功能.</p>
<h5 id="typingfinal">typing.Final<a class="headerlink" href="#typingfinal" title="Permanent link">&para;</a></h5>
<p><mark class="critic"><strong>告知类型检查器某名称不能再次赋值或在子类中重写的特殊类型构造器</strong></mark>。例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">MAX_SIZE</span><span class="p">:</span> <span class="n">Final</span> <span class="o">=</span> <span class="mi">9000</span>
<span class="n">MAX_SIZE</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Error reported by type checker</span>

<span class="k">class</span> <span class="nc">Connection</span><span class="p">:</span>
    <span class="n">TIMEOUT</span><span class="p">:</span> <span class="n">Final</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">class</span> <span class="nc">FastConnector</span><span class="p">(</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Error reported by type checker</span>
</code></pre></div>
<p>这些属性没有运行时检查。详见 <a href="https://www.python.org/dev/peps/pep-0591">PEP 591</a>。</p>
<p>3.8 新版功能.</p>
<h5 id="typingannotated">typing.Annotated<a class="headerlink" href="#typingannotated" title="Permanent link">&para;</a></h5>
<p><a href="https://www.python.org/dev/peps/pep-0593">PEP 593</a> （<em>灵活函数和变量注解</em>）里引入的类型，可以用上下文特定元数据（<code>Annotated</code> 的参数可变，也可能用它的多个组成部分）装饰现有的类型。具体来说，就是类型提示 <code>Annotated[T, x]</code> 用元数据 <code>x</code> 注解类型 <code>T</code>。
静态分析或运行时都能使用该元数据。库（或工具）处理类型提示 <code>Annotated[T, x]</code> 时，在元数据 <code>x</code> 不涉及特殊逻辑的情况下，可忽略该类型提示，仅把它当作类型 <code>T</code>。
与 <code>typing</code> 模块中现有的 <code>no_type_check</code> 功能不同，该功能完全禁用了函数或类的类型检查注解，而 <code>Annotated</code> 类型则允许对 <code>T</code> 进行静态类型检查（可安全地忽略 <code>x</code>），
也可以在特定应用程序中实现 <code>x</code> 的运行时访问。</p>
<p>毕竟，如何解释注解（如有）由处理 <code>Annotated</code> 类型的工具/库负责。工具/库处理 Annotated 类型时，扫描所有注解以确定是否需要进行处理（例如，使用 <code>isinstance()</code>）。</p>
<p>工具/库不支持注解，或遇到未知注解时，应忽略注解，并把注解类型当作底层类型。</p>
<p>是否允许客户端在一个类型上使用多个注解，以及如何合并这些注解，由处理注解的工具决定。</p>
<p><code>Annotated</code> 类型支持把多个相同（或不同）的单个（或多个）类型注解置于任意节点。因此，使用这些注解的工具/库要负责处理潜在的重复项。例如，执行值范围分析时，应允许以下操作：</p>
<div class="highlight"><pre><span></span><code><span class="n">T1</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">T1</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
</code></pre></div>
<p>传递 <code>include_extras=True</code> 至 <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#typing.get_type_hints">get_type_hints()</a> ，即可在运行时访问额外的注解。</p>
<p>语义详情：</p>
<ul>
<li><code>Annotated</code> 的第一个参数必须是有效类型。</li>
<li>
<p>支持多个类型标注（<code>Annotated</code> 支持可变参数）：</p>
<div class="highlight"><pre><span></span><code><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ctype</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">)]</span>
</code></pre></div>
</li>
<li>
<p>调用 <code>Annotated</code> 至少要有两个参数（<code>Annotated[int]</code> 是无效的）</p>
</li>
<li>
<p>注解的顺序会被保留，且影响等价检查：</p>
<div class="highlight"><pre><span></span><code><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ctype</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">)]</span> <span class="o">!=</span> <span class="n">Annotated</span><span class="p">[</span>
    <span class="nb">int</span><span class="p">,</span> <span class="n">ctype</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">),</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</li>
<li>
<p>嵌套 <code>Annotated</code> 类型会被展平，元数据从最内层注解依序展开：</p>
<div class="highlight"><pre><span></span><code><span class="n">Annotated</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)],</span> <span class="n">ctype</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">)]</span> <span class="o">==</span> <span class="n">Annotated</span><span class="p">[</span>
    <span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ctype</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</li>
<li>
<p>不移除注解重复项：</p>
<div class="highlight"><pre><span></span><code><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span> <span class="o">!=</span> <span class="n">Annotated</span><span class="p">[</span>
    <span class="nb">int</span><span class="p">,</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ValueRange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><code>Annotated</code> 可用于嵌套或泛型别名：</p>
<div class="highlight"><pre><span></span><code><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">Vec</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">]],</span> <span class="n">MaxLen</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">Vec</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

<span class="n">V</span> <span class="o">==</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">MaxLen</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</code></pre></div>
</li>
</ul>
<p>3.9 新版功能.</p>
<h5 id="typingtypeguard">typing.TypeGuard<a class="headerlink" href="#typingtypeguard" title="Permanent link">&para;</a></h5>
<p>用于注释用户定义的类型保护函数的返回类型的特殊类型化形式。 <code>TypeGuard</code> 只接受一个单一的类型参数。 在运行时，以这种方式标记的函数应该返回一个布尔值。</p>
<p>PX旨在使 <em>类型缩小</em> 受益--这是静态类型检查器用来确定程序代码流中表达式的更精确类型的一种技术。通常，类型缩小是通过分析条件性代码流并将缩小的结果应用于一个代码块来完成的。 这里的条件表达式有时被称为 "类型保护":</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_str</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
    <span class="c1"># &quot;isinstance&quot; type guard</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Type of ``val`` is narrowed to ``str``</span>
        <span class="o">...</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Else, type of ``val`` is narrowed to ``float``.</span>
        <span class="o">...</span>
</code></pre></div>
<p>有时，使用一个用户定义的布尔函数作为类型保护会很方便。 这样的函数应该使用 <code>TypeGuard[...]</code> 作为其返回类型，以提醒静态类型检查器注意这一意图。</p>
<p>对于一个给定的函数，使用 <code>-&gt; TypeGuard</code> 告诉静态类型检查器:</p>
<ol>
<li>返回值是一个布尔值。</li>
<li>如果返回值是 <code>True</code>，其参数的类型是 <code>TypeGuard</code> 里面的类型。</li>
</ol>
<p>例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">TypeGuard</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Determines whether all objects in the list are strings&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">is_str_list</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="c1"># Type of ``val`` is narrowed to ``List[str]``.</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Type of ``val`` remains as ``List[object]``.</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not a list of strings!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>如果 <code>is_str_list</code> 是一个类或实例方法，那么 <code>TypeGuard</code> 中的类型映射到 <code>cls</code> 或 <code>self</code> 之后的第二个参数的类型。</p>
<p>简而言之，<code>def foo(arg: TypeA) -&gt; TypeGuard[TypeB]: ...</code> 形式的意思是：如果 <code>foo(arg)</code> 返回 <code>True</code>，那么 <code>arg</code> 将把 <code>TypeA</code> 缩小为 <code>TypeB</code>。</p>
<blockquote>
<p><strong>注解</strong>:</p>
<p><code>TypeB</code> 不必是 <code>TypeA</code> 的缩小形式，它甚至可以是扩大形式。 主要原因是允许像把 <code>List[object]</code> 缩小到 <code>List[str]</code> 这样的事情，即使后者不是前者的一个子类型，因为 <code>List</code> 是不变的。 编写类型安全的类型防护的责任留给了用户。</p>
</blockquote>
<p><code>TypeGuard</code> also works with type variables. See <a href="https://www.python.org/dev/peps/pep-0647">PEP 647</a> for more details.</p>
<p>3.10 新版功能.</p>
<h4 id="构建泛型类型">构建泛型类型<a class="headerlink" href="#构建泛型类型" title="Permanent link">&para;</a></h4>
<p>以下内容是创建泛型类型的基石，但不在注解内使用。</p>
<h5 id="class-typinggeneric">class typing.Generic<a class="headerlink" href="#class-typinggeneric" title="Permanent link">&para;</a></h5>
<p>用于泛型类型的抽象基类。</p>
<p>泛型类型一般通过继承含一个或多个类型变量的类实例进行声明。例如，泛型映射类型定义如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Mapping</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">KT</span><span class="p">,</span> <span class="n">VT</span><span class="p">]):</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">KT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VT</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="c1"># Etc.</span>
</code></pre></div>
<p>该类的用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="n">X</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">lookup_name</span><span class="p">(</span><span class="n">mapping</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Y</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">default</span>
</code></pre></div>
<h5 id="class-typingtypevar">class typing.TypeVar<a class="headerlink" href="#class-typingtypevar" title="Permanent link">&para;</a></h5>
<p>类型变量。</p>
<p>用法：</p>
<div class="highlight"><pre><span></span><code><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>  <span class="c1"># Can be anything</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>  <span class="c1"># Can be any subtype of str</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>  <span class="c1"># Must be exactly str or bytes</span>
</code></pre></div>
<p>类型变量主要是为静态类型检查器提供支持，用于泛型类型与泛型函数定义的参数。有关泛型类型，详见 <a href="#class-typinggeneric">Generic</a>。泛型函数的写法如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list containing n references to x.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>


<span class="k">def</span> <span class="nf">print_capitalized</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print x capitalized, and return x.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">A</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">A</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add two strings or bytes objects together.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div>
<p>请注意，类型变量可以是 <em>被绑定的</em> ， <em>被约束的</em> ，或者两者都不是，但不能既是被绑定的 <em>又是</em> 被约束的。</p>
<p>约束类型变量和绑定类型变量在几个重要方面具有不同的语义。使用 <em>约束</em> 类型变量意味着它只能被解析为正好是所给的约束之一:</p>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">)</span>  <span class="c1"># Ok, variable &#39;a&#39; has type &#39;str&#39;</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="n">StringSubclass</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">),</span> <span class="n">StringSubclass</span><span class="p">(</span><span class="s1">&#39;two&#39;</span><span class="p">))</span>  <span class="c1"># Inferred type of variable &#39;b&#39; is &#39;str&#39;,</span>
                                                               <span class="c1"># despite &#39;StringSubclass&#39; being passed in</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;two&#39;</span><span class="p">)</span>  <span class="c1"># error: type variable &#39;A&#39; can be either &#39;str&#39; or &#39;bytes&#39; in a function call, but not both</span>
</code></pre></div>
<p>然而，使用一个 <em>绑定</em> 类型变量，意味着将使用最具体的类型来解析 <code>TypeVar</code></p>
<div class="highlight"><pre><span></span><code><span class="n">print_capitalized</span><span class="p">(</span><span class="s1">&#39;a string&#39;</span><span class="p">)</span>  <span class="c1"># Ok, output has type &#39;str&#39;</span>

<span class="k">class</span> <span class="nc">StringSubclass</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">print_capitalized</span><span class="p">(</span><span class="n">StringSubclass</span><span class="p">(</span><span class="s1">&#39;another string&#39;</span><span class="p">))</span>  <span class="c1"># Ok, output has type &#39;StringSubclass&#39;</span>
<span class="n">print_capitalized</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># error: int is not a subtype of str</span>
</code></pre></div>
<p>类型变量可以被绑定到具体类型、抽象类型（ <code>ABC</code> 或 <code>protocol</code> ），甚至是类型的联合:</p>
<div class="highlight"><pre><span></span><code><span class="n">U</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="nb">str</span><span class="o">|</span><span class="nb">bytes</span><span class="p">)</span>  <span class="c1"># Can be any subtype of the union str|bytes</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">SupportsAbs</span><span class="p">)</span>  <span class="c1"># Can be anything with an __abs__ method</span>
</code></pre></div>
<p>绑定类型变量对于注释用作替代构造函数的<a href="https://docs.python.org/zh-cn/3.10/library/functions.html#classmethod">类方法</a>特别有用。
在以下示例中（由 [Raymond Hettinger] 编写），类型变量 <code>C</code> 通过使用前向引用绑定到 <code>Circle</code> 类。
使用此类型变量来注释 <code>with_circumference</code> 类方法，而不是将返回类型硬编码为 <code>Circle</code>，这意味着即使在子类上调用该方法，类型检查器也可以正确推断返回类型：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">math</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s1">&#39;Circle&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Circle</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An abstract circle&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>

    <span class="c1"># Use a type variable to show that the return type</span>
    <span class="c1"># will always be an instance of whatever ``cls`` is</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">with_circumference</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">C</span><span class="p">],</span> <span class="n">circumference</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">C</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a circle with the specified circumference&quot;&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="n">circumference</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Tire</span><span class="p">(</span><span class="n">Circle</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A specialised circle (made out of rubber)&quot;&quot;&quot;</span>

    <span class="n">MATERIAL</span> <span class="o">=</span> <span class="s1">&#39;rubber&#39;</span>


<span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="o">.</span><span class="n">with_circumference</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Ok, variable &#39;c&#39; has type &#39;Circle&#39;</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tire</span><span class="o">.</span><span class="n">with_circumference</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># Ok, variable &#39;t&#39; has type &#39;Tire&#39; (not &#39;Circle&#39;)</span>
</code></pre></div>
<p>在运行时，<code>isinstance(x, T)</code> 会触发 <code>TypeError</code> 异常。一般而言，<code>isinstance()</code> 和 <code>issubclass()</code> 不应与类型搭配使用。</p>
<p>类型变量可以通过传递 <code>covariant=True</code> 或 <code>contravariant=True</code> 来标记协变或反变。 更多细节请参见 <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> 。 默认情况下，类型变量是不变的。</p>
<h5 id="class-typingparamspec">class typing.ParamSpec<a class="headerlink" href="#class-typingparamspec" title="Permanent link">&para;</a></h5>
<p><strong>class typing.ParamSpec(name, *, bound=None, covariant=False, contravariant=False)</strong></p>
<p>参数规范变量。 <a href="#generic">类型变量</a> 的一个专门版本。</p>
<p>用法：</p>
<div class="highlight"><pre><span></span><code><span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
</code></pre></div>
<p>参数规范变量的存在主要是为了使静态类型检查器受益。 它们被用来将一个可调用对象的参数类型转发给另一个可调用对象的参数类型——这种模式通常出现在高阶函数和装饰器中。
它们只有在 <code>Concatenate</code> 中使用时才有效，或者作为 <code>Callable</code> 的第一个参数，或者作为用户定义的泛型的参数。 参见 <a href="#class-typinggeneric">Generic</a> 以了解更多关于泛型的信息。</p>
<p>例如，为了给一个函数添加基本的日志记录，我们可以创建一个装饰器 <code>add_logging</code> 来记录函数调用。 参数规范变量告诉类型检查器，传入装饰器的可调用对象和由其返回的新可调用对象有相互依赖的类型参数:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">ParamSpec</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_logging</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;A type-safe decorator to add logging to a function.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> was called&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inner</span>

<span class="nd">@add_logging</span>
<span class="k">def</span> <span class="nf">add_two</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Add two numbers together.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div>
<p>如果没有 <a href="#typingparamspec">ParamSpec</a>，以前注释这个的最简单的方法是使用一个 <a href="#typingtypevar">TypeVar</a> 与绑定 <code>Callable[..., Any]</code>。</p>
<ol>
<li>类型检查器不能对 <code>inner</code> 函数进行类型检查，因为 <code>*args</code> 和 <code>**kwargs</code> 的类型必须是 <a href="#typingany">Any</a>。</li>
<li><a href="#typingcast">cast()</a> 在返回 <code>inner</code> 函数时，可能需要在 <code>add_logging</code> 装饰器的主体中进行，或者必须告诉静态类型检查器忽略 <code>return inner</code>。</li>
</ol>
<h6 id="args">args<a class="headerlink" href="#args" title="Permanent link">&para;</a></h6>
<h6 id="kwargs">Kwargs<a class="headerlink" href="#kwargs" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>由于 `ParamSpec` 同时捕获了位置参数和关键字参数，`P.args` 和 `P.kwargs` 可以用来将 `ParamSpec` 分割成其组成部分。 `P.args` 代表给定调用中的位置参数的元组，只能用于注释 `*args`。 `P.kwargs` 代表给定调用中的关键字参数到其值的映射，只能用于注释 `**kwargs`。在运行时，`P.args` 和 `P.kwargs` 分别是 [ParamSpecArgs] 和 [ParamSpecKwargs] 的实例。
</code></pre></div>
<p>用 <code>covariant=True</code> 或 <code>contravariant=True</code> 创建的参数规范变量可以用来声明协变或禁变的通用类型。 参数 <code>bound</code> 也被接受，类似于 <code>TypeVar</code>。 然而这些关键字的实际语义还有待决定。</p>
<p>3.10 新版功能.</p>
<blockquote>
<p>注解: 只有在全局范围内定义的参数规范变量可以被 pickle。</p>
<p>参见</p>
<ul>
<li><a href="https://www.python.org/dev/peps/pep-0612">PEP 612</a> -- 参数规范变量（引入 <code>ParamSpec</code> 和 <code>Concatenate</code> 的 PEP）。</li>
<li><a href="#typingcallable">Callable</a> 和 <a href="#typingconcatenate">Concatenate</a>。</li>
</ul>
</blockquote>
<h5 id="typingparamspecargs">typing.ParamSpecArgs<a class="headerlink" href="#typingparamspecargs" title="Permanent link">&para;</a></h5>
<h5 id="typingparamspeckwargs">typing.ParamSpecKwargs<a class="headerlink" href="#typingparamspeckwargs" title="Permanent link">&para;</a></h5>
<p><code>ParamSpec</code>的参数和关键字参数属性。<code>ParamSpec</code> 的 <code>P.args</code> 属性是 <code>ParamSpecArgs</code> 的一个实例，<code>P.kwargs</code> 是 <code>ParamSpecKwargs</code> 的一个实例。 它们的目的是用于运行时内部检查的，对静态类型检查器没有特殊意义。</p>
<p>在这些对象中的任何一个上调用 <code>get_origin()</code>，都会返回原始的 <code>ParamSpec</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">)</span>
<span class="n">get_origin</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># returns P</span>
<span class="n">get_origin</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># returns P</span>
</code></pre></div>
<p>3.10 新版功能.</p>
<h5 id="typinganystr">typing.AnyStr<a class="headerlink" href="#typinganystr" title="Permanent link">&para;</a></h5>
<p><code>AnyStr</code> 定义为 <code>AnyStr = TypeVar('AnyStr', str, bytes)</code> 的 <a href="#class-typingtypevar">约束类型变量</a> 。</p>
<p>这里指的是，它可以接受任意同类字符串，但不支持混用不同类别的字符串。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">AnyStr</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">AnyStr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyStr</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">concat</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>  <span class="c1"># Ok, output has type &#39;unicode&#39;</span>
<span class="n">concat</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>  <span class="c1"># Ok, output has type &#39;bytes&#39;</span>
<span class="n">concat</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>  <span class="c1"># Error, cannot mix unicode and bytes</span>
</code></pre></div>
<h5 id="class-typingprotocolgeneric">class typing.Protocol(Generic)<a class="headerlink" href="#class-typingprotocolgeneric" title="Permanent link">&para;</a></h5>
<p><code>Protocol</code> 类的基类。<code>Protocol</code> 类的定义如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Proto</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="o">...</span>
</code></pre></div>
<p>这些类主要与静态类型检查器搭配使用，用来识别结构子类型（静态鸭子类型），例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Proto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>

<span class="n">func</span><span class="p">(</span><span class="n">C</span><span class="p">())</span>  <span class="c1"># Passes static type check</span>
</code></pre></div>
<p>有关详细信息，请参阅 <a href="https://www.python.org/dev/peps/pep-0544">PEP 544</a>。 用 <a href="#typingruntime_checkable">runtime_checkable()</a> 装饰的协议类（稍后描述）充当头脑简单的运行时协议，只检查给定属性的存在，忽略它们的类型签名。</p>
<p><code>Protocol</code> 类可以是泛型，例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GenProto</span><span class="p">(</span><span class="n">Protocol</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="o">...</span>
</code></pre></div>
<p>3.8 新版功能.</p>
<h5 id="typingruntime_checkable">@typing.runtime_checkable<a class="headerlink" href="#typingruntime_checkable" title="Permanent link">&para;</a></h5>
<p>用于把 <code>Protocol</code> 类标记为运行时协议。</p>
<p>该协议可以与 <code>isinstance()</code> 和 <code>issubclass()</code> 一起使用。应用于非协议的类时，会触发 <code>TypeError</code>。该指令支持简易结构检查，与 <code>collections.abc</code> 的 <code>Iterable</code> 非常类似，只擅长做一件事。 例如：</p>
<div class="highlight"><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span> <span class="nc">Closable</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/some/file&#39;</span><span class="p">),</span> <span class="n">Closable</span><span class="p">)</span>

<span class="nd">@runtime_checkable</span>
<span class="k">class</span> <span class="nc">Named</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

<span class="kn">import</span> <span class="nn">threading</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bob&#39;</span><span class="p">),</span> <span class="n">Named</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>注解: <code>runtime_checkable()</code> 将只检查所需方法或属性的存在，而不是它们的类型签名或类型。 例如，<a href="https://docs.python.org/zh-cn/3.10/library/ssl.html#ssl.SSLObject">ssl.SSLObject</a> 是一个类，因此它通过了针对 <a href="#typingcallable">Callable</a> 的 [issubclass()] 检查。 但是，<code>ssl.SSLObject.__init__</code> 方法的存在只是为了引发 <a href="https://docs.python.org/zh-cn/3.10/library/exceptions.html#TypeError">TypeError</a> 并提供更多信息，因此无法调用（实例化）<a href="https://docs.python.org/zh-cn/3.10/library/ssl.html#ssl.SSLObject">ssl.SSLObject</a>。</p>
<p>注解: 与针对非协议类的 <code>isinstance()</code> 检查相比，针对运行时可检查协议的 <code>isinstance()</code> 检查可能出奇地慢。 考虑使用替代习惯用法，例如 <code>hasattr()</code> 调用以在性能敏感代码中进行结构检查。</p>
</blockquote>
<p>3.8 新版功能.</p>
<h4 id="其他特殊指令">其他特殊指令<a class="headerlink" href="#其他特殊指令" title="Permanent link">&para;</a></h4>
<p>这些特殊指令是声明类型的基石，但不在注解内使用。</p>
<h5 id="class-typingnamedtuple">class typing.NamedTuple<a class="headerlink" href="#class-typingnamedtuple" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.namedtuple">collections.namedtuple()</a> 的类型版本。</p>
<p>用法：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p>这相当于：</p>
<div class="highlight"><pre><span></span><code><span class="n">Employee</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Employee&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">])</span>
</code></pre></div>
<p>为字段提供默认值，要在类体内赋值：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># 带默认值的字段必须在不带默认值的字段后面。</span>

<span class="n">employee</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">(</span><span class="s1">&#39;Guido&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">employee</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">3</span>
</code></pre></div>
<p>带默认值的字段必须在不带默认值的字段后面。</p>
<p>由此产生的类有一个额外的属性 <code>__annotations__</code> ，给出一个 dict ，将字段名映射到字段类型。（字段名在 <code>_fields</code> 属性中，默认值在 <code>_field_defaults</code> 属性中，这两者都是 <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.namedtuple">namedtuple()</a> API 的一部分。）</p>
<p><code>NamedTuple</code> 子类也支持文档字符串与方法：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an employee.&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;Employee </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</code></pre></div>
<p>反向兼容法:</p>
<div class="highlight"><pre><span></span><code><span class="n">Employee</span> <span class="o">=</span> <span class="n">NamedTuple</span><span class="p">(</span><span class="s1">&#39;Employee&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)])</span>
</code></pre></div>
<p>在 3.6 版更改: 添加了对 <a href="https://www.python.org/dev/peps/pep-0526">PEP 526</a> 中变量注解句法的支持。</p>
<p>在 3.6.1 版更改: 添加了对默认值、方法、文档字符串的支持。</p>
<p>在 3.8 版更改: <code>_field_types</code> 和 <code>__annotations__</code> 属性现已使用常规字典，不再使用 <code>OrderedDict</code> 实例。</p>
<p>在 3.9 版更改: 移除了 <code>_field_types</code> 属性， 改用具有相同信息，但更标准的 <code>__annotations__</code> 属性。</p>
<h5 id="class-typingnewtypename-tp">class typing.NewType(name, tp)<a class="headerlink" href="#class-typingnewtypename-tp" title="Permanent link">&para;</a></h5>
<p>一个辅助类，用于向类型检查器指示一个不同的类型，见 <a href="#newtype">NewType</a>。在运行时，它返回一个对象，在调用时返回其参数。用法:</p>
<div class="highlight"><pre><span></span><code><span class="n">UserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;UserId&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">first_user</span> <span class="o">=</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>3.5.2 新版功能.</p>
<p>在 3.10 版更改: <code>NewType</code> 现在是一个类而不是函数。</p>
<h5 id="class-typingtypeddictdict">class typing.TypedDict(dict)<a class="headerlink" href="#class-typingtypeddictdict" title="Permanent link">&para;</a></h5>
<p>把类型提示添加至字典的特殊构造器。在运行时，它是纯 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#dict">dict</a>。</p>
<p><code>TypedDict</code> 声明一个字典类型，该类型预期所有实例都具有一组键集，其中，每个键都与对应类型的值关联。运行时不检查此预期，而是由类型检查器强制执行。用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">a</span><span class="p">:</span> <span class="n">Point2D</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;good&#39;</span><span class="p">}</span>  <span class="c1"># OK</span>
<span class="n">b</span><span class="p">:</span> <span class="n">Point2D</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;bad&#39;</span><span class="p">}</span>           <span class="c1"># Fails type check</span>

<span class="k">assert</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
</code></pre></div>
<p>为了允许在不支持 <a href="https://www.python.org/dev/peps/pep-0526">PEP 526</a> 的旧版本的 Python 中使用这个特性， <code>TypedDict</code> 支持另外两种等价的语法形式:</p>
<div class="highlight"><pre><span></span><code><span class="n">Point2D</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span><span class="s1">&#39;Point2D&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">Point2D</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span><span class="s1">&#39;Point2D&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</code></pre></div>
<p>当任何一个键不是有效的 <a href="https://docs.python.org/zh-cn/3.10/reference/lexical_analysis.html#identifiers">标识符</a> 时，例如因为它们是关键字或包含连字符，也应该使用函数式语法。例子:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># raises SyntaxError</span>
<span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="ow">in</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># &#39;in&#39; is a keyword</span>
    <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># name with hyphens</span>

<span class="c1"># OK, functional syntax</span>
<span class="n">Point2D</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span><span class="s1">&#39;Point2D&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;in&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;x-y&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span>
</code></pre></div>
<p>默认情况下，所有的键都必须出现在一个 <code>TypedDict</code> 中。 可以通过指定总数来重写这一点。用法:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p>这意味着一个 <code>Point2D</code> <code>TypedDict</code> 可以省略任何一个键。 类型检查器只需要支持一个字面的 <code>False</code> 或 <code>True</code> 作为 <code>total</code> 参数的值。 <code>True</code> 是默认的，它使类主体中定义的所有项目都是必需的。</p>
<p>一个 <code>TypedDict</code> 类型有可能使用基于类的语法从一个或多个其他 <code>TypedDict</code> 类型继承。用法:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Point3D</span><span class="p">(</span><span class="n">Point2D</span><span class="p">):</span>
    <span class="n">z</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p><code>Point3D</code> 有三个项目 : <code>x</code> , <code>y</code> 和 <code>z</code> 。 其等价于定义:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Point3D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">z</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p><code>TypedDict</code> 不能继承于一个非 <code>TypedDict</code> 类，其中特别包括 <a href="#class-typinggeneric">Generic</a> 。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span> <span class="nc">Y</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># A non-TypedDict class</span>

<span class="k">class</span> <span class="nc">XY</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># OK</span>

<span class="k">class</span> <span class="nc">XZ</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># raises TypeError</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">XT</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span> <span class="k">pass</span>  <span class="c1"># raises TypeError</span>
</code></pre></div>
<p><code>TypedDict</code> 可以通过注解字典（参见 <a href="https://docs.python.org/zh-cn/3.10/howto/annotations.html#annotations-howto">对象注解属性的最佳实践</a> 了解更多关于注解的最佳实践）、 [<strong>total</strong>] 、 [<strong>required_keys</strong>] 和 [<strong>optional_keys</strong>] 进行内省。</p>
<h6 id="__total__">__total__<a class="headerlink" href="#__total__" title="Permanent link">&para;</a></h6>
<p><code>Point2D.__total__</code> 给出总参数的值。 例子：</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypedDict</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span> <span class="k">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point2D</span><span class="o">.</span><span class="n">__total__</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> <span class="k">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point2D</span><span class="o">.</span><span class="n">__total__</span>
<span class="kc">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Point3D</span><span class="p">(</span><span class="n">Point2D</span><span class="p">):</span> <span class="k">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point3D</span><span class="o">.</span><span class="n">__total__</span>
<span class="kc">True</span>
</code></pre></div>
<h6 id="__required_keys__">__required_keys__<a class="headerlink" href="#__required_keys__" title="Permanent link">&para;</a></h6>
<p>3.9 新版功能.</p>
<h6 id="__optional_keys__">__optional_keys__<a class="headerlink" href="#__optional_keys__" title="Permanent link">&para;</a></h6>
<p><code>Point2D.__required_keys__</code> 和 <code>Point2D.__optional_keys__</code> 分别返回 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#frozenset">frozenset</a> 对象，其中包含必需和非必需键。目前，在同一个 中声明必需和非必需键的唯一方法是混合继承，用一个 <code>total</code> 参数值声明一个 <code>TypedDict</code> ，然后从另一个 <code>total</code> 参数值不同的 <code>TypedDict</code> 中继承它。用法：</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
<span class="o">...</span>     <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Point3D</span><span class="p">(</span><span class="n">Point2D</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">z</span><span class="p">:</span> <span class="nb">int</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point3D</span><span class="o">.</span><span class="n">__required_keys__</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;z&#39;</span><span class="p">})</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Point3D</span><span class="o">.</span><span class="n">__optional_keys__</span> <span class="o">==</span> <span class="nb">frozenset</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>
<span class="kc">True</span>
</code></pre></div>
<p>3.9 新版功能.</p>
<p>更多示例与 <code>TypedDict</code> 的详细规则，详见 <a href="https://www.python.org/dev/peps/pep-0589">PEP 589</a>。</p>
<p>3.8 新版功能.</p>
<h3 id="泛型具象容器">泛型具象容器<a class="headerlink" href="#泛型具象容器" title="Permanent link">&para;</a></h3>
<h4 id="对应的内置类型">对应的内置类型<a class="headerlink" href="#对应的内置类型" title="Permanent link">&para;</a></h4>
<h5 id="class-typingdictdict-mutablemappingkt-vt">class typing.Dict(dict, MutableMapping[KT, VT])<a class="headerlink" href="#class-typingdictdict-mutablemappingkt-vt" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#dict">dict</a> 的泛型版本。适用于注解返回类型。注解参数时，最好使用 <a href="#class-typingmapping">Mapping</a> 等抽象容器类型。</p>
<p>该类型用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">count_words</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="o">...</span>
</code></pre></div>
<p>3.9 版后已移除: [builtins.dict] now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typinglistlist-mutablesequencet">class typing.List(list, MutableSequence[T])<a class="headerlink" href="#class-typinglistlist-mutablesequencet" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#list">list</a> 的泛型版本。适用于注解返回类型。注解参数时，最好使用 <a href="#class-typingsequence">Sequence</a> 或 <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterable">Iterable</a> 等抽象容器类型。</p>
<p>该类型用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vec2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">keep_positives</span><span class="p">(</span><span class="n">vector</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">vector</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#list">builtins.list</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingsetset-mutablesett">class typing.Set(set, MutableSet[T])<a class="headerlink" href="#class-typingsetset-mutablesett" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#set">builtins.set</a> 的泛型版本。适用于注解返回类型。注解参数时，最好使用 <a href="#class-typingabstractset">AbstractSet</a> 等抽象容器类型。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#set">builtins.set</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingfrozensetfrozenset-abstractsett_co">class typing.FrozenSet(frozenset, AbstractSet[T_co])<a class="headerlink" href="#class-typingfrozensetfrozenset-abstractsett_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#frozenset">builtins.frozenset</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#frozenset">builtins.frozenset</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<blockquote>
<p><strong>注解</strong> <a href="#typingtuple">Tuple</a> 是一种特殊形式。</p>
</blockquote>
<h4 id="collections-对应类型"><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#module-collections">collections</a> 对应类型<a class="headerlink" href="#collections-对应类型" title="Permanent link">&para;</a></h4>
<h5 id="class-typingdefaultdictcollectionsdefaultdict-mutablemappingkt-vt">class typing.DefaultDict(collections.defaultdict, MutableMapping[KT, VT])<a class="headerlink" href="#class-typingdefaultdictcollectionsdefaultdict-mutablemappingkt-vt" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.defaultdict">collections.defaultdict</a> 的泛型版本。</p>
<p>3.5.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.defaultdict">collections.defaultdict</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingordereddictcollectionsordereddict-mutablemappingkt-vt">class typing.OrderedDict(collections.OrderedDict, MutableMapping[KT, VT])<a class="headerlink" href="#class-typingordereddictcollectionsordereddict-mutablemappingkt-vt" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.OrderedDict">collections.OrderedDict</a> 的泛型版本。</p>
<p>3.7.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.OrderedDict">collections.OrderedDict</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingchainmapcollectionschainmap-mutablemappingkt-vt">class typing.ChainMap(collections.ChainMap, MutableMapping[KT, VT])<a class="headerlink" href="#class-typingchainmapcollectionschainmap-mutablemappingkt-vt" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.ChainMap">collections.ChainMap</a> 的泛型版本。</p>
<p>3.5.4 新版功能.</p>
<p>3.6.1 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.ChainMap">collections.ChainMap</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingcountercollectionscounter-dictt-int">class typing.Counter(collections.Counter, Dict[T, int])<a class="headerlink" href="#class-typingcountercollectionscounter-dictt-int" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.Counter">collections.Counter</a> 的泛型版本。</p>
<p>3.5.4 新版功能.</p>
<p>3.6.1 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.Counter">collections.Counter</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingdequedeque-mutablesequencet">class typing.Deque(deque, MutableSequence[T])<a class="headerlink" href="#class-typingdequedeque-mutablesequencet" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.deque">collections.deque</a> 的泛型版本。</p>
<p>3.5.4 新版功能.</p>
<p>3.6.1 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#collections.deque">collections.deque</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h4 id="其他具象类型">其他具象类型<a class="headerlink" href="#其他具象类型" title="Permanent link">&para;</a></h4>
<h5 id="class-typingio">class typing.IO<a class="headerlink" href="#class-typingio" title="Permanent link">&para;</a></h5>
<h5 id="class-typingtextio">class typing.TextIO<a class="headerlink" href="#class-typingtextio" title="Permanent link">&para;</a></h5>
<h5 id="calss-typingbinaryio">calss typing.BinaryIO<a class="headerlink" href="#calss-typingbinaryio" title="Permanent link">&para;</a></h5>
<p>泛型类型 <code>IO[AnyStr]</code> 及其子类 <code>TextIO(IO[str])</code> 与 <code>BinaryIO(IO[bytes])</code> 表示 I/O 流的类型，例如 <a href="https://docs.python.org/zh-cn/3.10/library/functions.html#open">open()</a> 所返回的对象。</p>
<p>从版本 3.8 开始标记为过时，将在版本 3.13 中移除。 <code>typing.io</code> 命名空间已被废弃并将被删除。这些类型应该被直接从 <code>typing</code> 导入。</p>
<h5 id="class-typingpattern">class typing.Pattern<a class="headerlink" href="#class-typingpattern" title="Permanent link">&para;</a></h5>
<h5 id="class-typingmatch">class typing.Match<a class="headerlink" href="#class-typingmatch" title="Permanent link">&para;</a></h5>
<p>这些类型对应的是从 [re.compile()] 和 [re.match()] 返回的类型。 这些类型（及相应的函数）是 <code>AnyStr</code> 中的泛型并可通过编写 <code>Pattern[str]</code>, <code>Pattern[bytes]</code>, <code>Match[str]</code> 或 <code>Match[bytes]</code> 来具体指定。</p>
<p>从版本 3.8 开始标记为过时，将在版本 3.13 中移除。 <code>typing.re</code> 命名空间已被废弃并将被删除。这些类型应该被直接从 <code>typing</code> 导入。</p>
<p>3.9 版后已移除: [re] 模块中的 <code>Pattern</code> 与 <code>Match</code> 类现已支持 <code>[]</code>。详见 <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> 与 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>。</p>
<h5 id="class-typingtext">class typing.Text<a class="headerlink" href="#class-typingtext" title="Permanent link">&para;</a></h5>
<p><code>Text</code> 是 <code>str</code> 的别名。提供了对 Python 2 代码的向下兼容Python 2 中，<code>Text</code> 是 unicode 的别名。</p>
<p>使用 <code>Text</code> 时，值中必须包含 <code>unicode</code> 字符串，以兼容 Python 2 和 Python 3：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_unicode_checkmark</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">text</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39; </span><span class="se">\u2713</span><span class="s1">&#39;</span>
</code></pre></div>
<p>3.5.2 新版功能.</p>
<h3 id="抽象基类">抽象基类<a class="headerlink" href="#抽象基类" title="Permanent link">&para;</a></h3>
<h4 id="collectionsabc-对应的容器"><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#module-collections.abc">collections.abc</a> 对应的容器<a class="headerlink" href="#collectionsabc-对应的容器" title="Permanent link">&para;</a></h4>
<h5 id="class-typingabstractsetcollectiont_co">class typing.AbstractSet(Collection[T_co])<a class="headerlink" href="#class-typingabstractsetcollectiont_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Set">collections.abc.Set</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Set">collections.abc.Set</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingbytestringsequenceint">class typing.ByteString(Sequence[int])<a class="headerlink" href="#class-typingbytestringsequenceint" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ByteString">collections.abc.ByteString</a> 的泛型版本。</p>
<p>该类型代表了 <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#bytes">bytes</a>、<a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#bytearray">bytearray</a>、<a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#memoryview">memoryview</a> 等字节序列类型。</p>
<p>作为该类型的简称，<a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#bytes">bytes</a> 可用于标注上述任意类型的参数。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ByteString">collections.abc.ByteString</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingcollectionsized-iterablet_co-containert_co">class typing.Collection(Sized, Iterable[T_co], Container[T_co])<a class="headerlink" href="#class-typingcollectionsized-iterablet_co-containert_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Collection">collections.abc.Collection</a> 的泛型版本。</p>
<p>3.6.0 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Collection">collections.abc.Collection</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingcontainergenerict_co">class typing.Container(Generic[T_co])<a class="headerlink" href="#class-typingcontainergenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Container">collections.abc.Container</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Container">collections.abc.Container</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingitemsviewmappingview-abstractsettuplekt_co-vt_co">class typing.ItemsView(MappingView, AbstractSet[tuple[KT_co, VT_co]])<a class="headerlink" href="#class-typingitemsviewmappingview-abstractsettuplekt_co-vt_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ItemsView">collections.abc.ItemsView</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ItemsView">collections.abc.ItemsView</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingkeysviewmappingview-abstractsetkt_co">class typing.KeysView(MappingView, AbstractSet[KT_co])<a class="headerlink" href="#class-typingkeysviewmappingview-abstractsetkt_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.KeysView">collections.abc.KeysView</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.KeysView">collections.abc.KeysView</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingmappingcollectionkt-generickt-vt_co">class typing.Mapping(Collection[KT], Generic[KT, VT_co])<a class="headerlink" href="#class-typingmappingcollectionkt-generickt-vt_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Mapping">collections.abc.Mapping</a> 的泛型版本。用法如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_position_in_index</span><span class="p">(</span><span class="n">word_list</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">word</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">word_list</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
</code></pre></div>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Mapping">collections.abc.Mapping</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingmappingviewsized">class typing.MappingView(Sized)<a class="headerlink" href="#class-typingmappingviewsized" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MappingView">collections.abc.MappingView</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MappingView">collections.abc.MappingView</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingmutablemappingmappingkt-vt">class typing.MutableMapping(Mapping[KT, VT])<a class="headerlink" href="#class-typingmutablemappingmappingkt-vt" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableMapping">collections.abc.MutableMapping</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableMapping">collections.abc.MutableMapping</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingmutablesequencesequencet">class typing.MutableSequence(Sequence[T])<a class="headerlink" href="#class-typingmutablesequencesequencet" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableSequence">collections.abc.MutableSequence</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableSequence">collections.abc.MutableSequence</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingmutablesetabstractsett">class typing.MutableSet(AbstractSet[T])<a class="headerlink" href="#class-typingmutablesetabstractsett" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableSet">collections.abc.MutableSet</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.MutableSet">collections.abc.MutableSet</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingsequencereversiblet_co-collectiont_co">class typing.Sequence(Reversible[T_co], Collection[T_co])<a class="headerlink" href="#class-typingsequencereversiblet_co-collectiont_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Sequence">collections.abc.Sequence</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Sequence">collections.abc.Sequence</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingvaluesviewmappingview-collection_vt_co">class typing.ValuesView(MappingView, Collection[_VT_co])<a class="headerlink" href="#class-typingvaluesviewmappingview-collection_vt_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ValuesView">collections.abc.ValuesView</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.ValuesView">collections.abc.ValuesView</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h4 id="collectionsabc-对应的其他类型">collections.abc 对应的其他类型<a class="headerlink" href="#collectionsabc-对应的其他类型" title="Permanent link">&para;</a></h4>
<h5 id="class-typingiterablegenerict_co">class typing.Iterable(Generic[T_co])<a class="headerlink" href="#class-typingiterablegenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterable">collections.abc.Iterable</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterable">collections.abc.Iterable</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingiteratoriterablet_co">class typing.Iterator(Iterable[T_co])<a class="headerlink" href="#class-typingiteratoriterablet_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterator">collections.abc.Iterator</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Iterator">collections.abc.Iterator</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typinggeneratoriteratort_co-generict_co-t_contra-v_co">class typing.Generator(Iterator[T_co], Generic[T_co, T_contra, V_co])<a class="headerlink" href="#class-typinggeneratoriteratort_co-generict_co-t_contra-v_co" title="Permanent link">&para;</a></h5>
<p>生成器可以由泛型类型 <code>Generator[YieldType, SendType, ReturnType]</code> 注解。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">echo_round</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="k">yield</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">sent</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sent</span> <span class="o">=</span> <span class="k">yield</span> <span class="nb">round</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;Done&#39;</span>
</code></pre></div>
<p>注意，与 <code>typing</code> 模块里的其他泛型不同， <a href="#class-typinggeneratoriteratort_co-generict_co-t_contra-v_co">Generator</a> 的 <code>SendType</code> 属于逆变行为，不是协变行为，也是不变行为。</p>
<p>如果生成器只产生值，可将 <code>SendType</code> 与 <code>ReturnType</code> 设为 <code>None</code>：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">infinite_stream</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">start</span>
        <span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>此外，还可以把生成器的返回类型注解为 <code>Iterable[YieldType]</code> 或 <code>Iterator[YieldType]</code>：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">infinite_stream</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">start</span>
        <span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Generator">collections.abc.Generator</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typinghashable">class typing.Hashable<a class="headerlink" href="#class-typinghashable" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Hashable">collections.abc.Hashable</a> 的别名。</p>
<h5 id="class-typingreversibleiterablet_co">class typing.Reversible(Iterable[T_co])<a class="headerlink" href="#class-typingreversibleiterablet_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Reversible">collections.abc.Reversible</a> 的泛型版本。</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Reversible">collections.abc.Reversible</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingsized">class typing.Sized<a class="headerlink" href="#class-typingsized" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Sized">collections.abc.Sized</a> 的别名。</p>
<h4 id="异步编程">异步编程<a class="headerlink" href="#异步编程" title="Permanent link">&para;</a></h4>
<h5 id="class-typingcoroutineawaitablev_co-generict_co-t_contra-v_co">class typing.Coroutine(Awaitable[V_co], Generic[T_co, T_contra, V_co])<a class="headerlink" href="#class-typingcoroutineawaitablev_co-generict_co-t_contra-v_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Coroutine">collections.abc.Coroutine</a> 的泛型版本。类型变量的差异和顺序与 Generator 的内容相对应，例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Coroutine</span>

<span class="n">c</span><span class="p">:</span> <span class="n">Coroutine</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>  <span class="c1"># Some coroutine defined elsewhere</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>                   <span class="c1"># Inferred type of &#39;x&#39; is list[str]</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">bar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="k">await</span> <span class="n">c</span>                    <span class="c1"># Inferred type of &#39;y&#39; is int</span>
</code></pre></div>
<p>3.5.3 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Coroutine">collections.abc.Coroutine</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingasyncgeneratorasynciteratort_co-generict_co-t_contra">class typing.AsyncGenerator(AsyncIterator[T_co], Generic[T_co, T_contra])<a class="headerlink" href="#class-typingasyncgeneratorasynciteratort_co-generict_co-t_contra" title="Permanent link">&para;</a></h5>
<p>异步生成器可由泛型类型 <code>AsyncGenerator[YieldType, SendType]</code> 注解。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">echo_round</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="k">yield</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">sent</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">rounded</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">round</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
        <span class="n">sent</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">rounded</span>
</code></pre></div>
<p>与常规生成器不同，异步生成器不能返回值，因此没有 <code>ReturnType</code> 类型参数。 与 <a href="#class-typinggeneratoriteratort_co-generict_co-t_contra-v_co">Generator</a> 类似，SendType 也属于逆变行为。</p>
<p>如果生成器只产生值，可将 <code>SendType</code> 设置为 <code>None</code>：</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">infinite_stream</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">start</span>
        <span class="n">start</span> <span class="o">=</span> <span class="k">await</span> <span class="n">increment</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</code></pre></div>
<p>此外，可用 <code>AsyncIterable[YieldType]</code> 或 <code>AsyncIterator[YieldType]</code> 注解生成器的返回类型：</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">infinite_stream</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">start</span>
        <span class="n">start</span> <span class="o">=</span> <span class="k">await</span> <span class="n">increment</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</code></pre></div>
<p>3.6.1 新版功能.</p>
<p>3.9 版后已移除: [collections.abc.AsyncGenerator] now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingasynciterablegenerict_co">class typing.AsyncIterable(Generic[T_co])<a class="headerlink" href="#class-typingasynciterablegenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.AsyncGenerator">collections.abc.AsyncIterable</a> 的泛型版本。</p>
<p>3.5.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.AsyncGenerator">collections.abc.AsyncIterable</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingasynciteratorasynciterablet_co">class typing.AsyncIterator(AsyncIterable[T_co])<a class="headerlink" href="#class-typingasynciteratorasynciterablet_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.AsyncIterator">collections.abc.AsyncIterator</a> 的泛型版本。</p>
<p>3.5.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.AsyncIterator">collections.abc.AsyncIterator</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingawaitablegenerict_co">class typing.Awaitable(Generic[T_co])<a class="headerlink" href="#class-typingawaitablegenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Awaitable">collections.abc.Awaitable</a> 的泛型版本。</p>
<p>3.5.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/collections.abc.html#collections.abc.Awaitable">collections.abc.Awaitable</a> now supports subscripting ([]).     See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h4 id="上下文管理器类型">上下文管理器类型<a class="headerlink" href="#上下文管理器类型" title="Permanent link">&para;</a></h4>
<h5 id="class-typingcontextmanagergenerict_co">class typing.ContextManager(Generic[T_co])<a class="headerlink" href="#class-typingcontextmanagergenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/contextlib.html#contextlib.AbstractContextManager">contextlib.AbstractContextManager</a> 的泛型版本。</p>
<p>3.5.4 新版功能.</p>
<p>3.6.0 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/contextlib.html#contextlib.AbstractContextManager">contextlib.AbstractContextManager</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h5 id="class-typingasynccontextmanagergenerict_co">class typing.AsyncContextManager(Generic[T_co])<a class="headerlink" href="#class-typingasynccontextmanagergenerict_co" title="Permanent link">&para;</a></h5>
<p><a href="https://docs.python.org/zh-cn/3.10/library/contextlib.html#contextlib.AbstractAsyncContextManager">contextlib.AbstractAsyncContextManager</a> 的泛型版本。</p>
<p>3.5.4 新版功能.</p>
<p>3.6.2 新版功能.</p>
<p>3.9 版后已移除: <a href="https://docs.python.org/zh-cn/3.10/library/contextlib.html#contextlib.AbstractAsyncContextManager">contextlib.AbstractAsyncContextManager</a> now supports subscripting ([]). See <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> and <a href="https://docs.python.org/zh-cn/3.10/library/stdtypes.html#types-genericalias">GenericAlias 类型</a>.</p>
<h3 id="协议">协议<a class="headerlink" href="#协议" title="Permanent link">&para;</a></h3>
<p>这些协议由 <a href="#typingruntime_checkable">runtime_checkable()</a> 装饰。</p>
<p><strong>class typing.SupportsAbs</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__abs__` 的抽象基类，是其返回类型里的协变量。
</code></pre></div>
<p><strong>class typing.SupportsBytes</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__bytes__` 的抽象基类。
</code></pre></div>
<p><strong>class typing.SupportsComplex</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__complex__` 的抽象基类。
</code></pre></div>
<p><strong>class typing.SupportsFloat</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__float__` 的抽象基类。
</code></pre></div>
<p><strong>class typing.SupportsIndex</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__index__` 的抽象基类。

3.8 新版功能.
</code></pre></div>
<p><strong>class typing.SupportsInt</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__int__` 的抽象基类。
</code></pre></div>
<p><strong>class typing.SupportsRound</strong></p>
<div class="highlight"><pre><span></span><code>含抽象方法 `__round__` 的抽象基类，是其返回类型的协变量。
</code></pre></div>
<h3 id="函数与装饰器">函数与装饰器<a class="headerlink" href="#函数与装饰器" title="Permanent link">&para;</a></h3>
<h4 id="typingcasttyp-val">typing.cast(typ, val)<a class="headerlink" href="#typingcasttyp-val" title="Permanent link">&para;</a></h4>
<p>把值强制转换为类型。</p>
<p>不变更返回值。对类型检查器而言，代表了返回值具有指定的类型，但运行时故意不做任何检查（以便让检查速度尽量快）。</p>
<h4 id="typingoverload">@typing.overload<a class="headerlink" href="#typingoverload" title="Permanent link">&para;</a></h4>
<p><code>@overload</code> 装饰器可以修饰支持多个不同参数类型组合的函数或方法。<code>@overload</code> - 装饰定义的系列必须紧跟一个非 <code>@overload</code>-装饰定义（用于同一个函数/方法）。
<code>@overload</code>-装饰定义仅是为了协助类型检查器， 因为该装饰器会被非 <code>@overload</code>-装饰定义覆盖，后者用于运行时，而且会被类型检查器忽略。
在运行时直接调用 <code>@overload</code> 装饰的函数会触发 <a href="https://docs.python.org/zh-cn/3.10/library/exceptions.html#NotImplementedError">NotImplementedError</a>。下面的重载示例给出了比联合类型或类型变量更精准的类型：</p>
<div class="highlight"><pre><span></span><code><span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>

<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="o">...</span>

<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="o">&lt;</span><span class="n">actual</span> <span class="n">implementation</span><span class="o">&gt;</span>
</code></pre></div>
<p>See <a href="https://www.python.org/dev/peps/pep-0484">PEP 484</a> for more details and comparison with other typing semantics.</p>
<h4 id="typingfinal_1">@typing.final<a class="headerlink" href="#typingfinal_1" title="Permanent link">&para;</a></h4>
<p>告知类型检查器被装饰的方法不能被覆盖，且被装饰的类不能作为子类的装饰器，例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
    <span class="nd">@final</span>
    <span class="k">def</span> <span class="nf">done</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>
<span class="k">class</span> <span class="nc">Sub</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">done</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Error reported by type checker</span>
        <span class="o">...</span>

<span class="nd">@final</span>
<span class="k">class</span> <span class="nc">Leaf</span><span class="p">:</span>
    <span class="o">...</span>
<span class="k">class</span> <span class="nc">Other</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>  <span class="c1"># Error reported by type checker</span>
    <span class="o">...</span>
</code></pre></div>
<p>这些属性没有运行时检查。详见 <a href="https://www.python.org/dev/peps/pep-0591">PEP 591</a>。</p>
<p>3.8 新版功能.</p>
<h4 id="typingno_type_check">@typing.no_type_check<a class="headerlink" href="#typingno_type_check" title="Permanent link">&para;</a></h4>
<p>标明注解不是类型提示的装饰器。</p>
<p>用作类或函数的 <a href="https://docs.python.org/zh-cn/3.10/glossary.html#term-decorator">decorator</a>。用于类时，递归地应用于该类中定义的所有方法，（但不影响超类或子类中定义的方法）。</p>
<p>本方法可直接修改函数。</p>
<h4 id="typingno_type_check_decorator">@typing.no_type_check_decorator<a class="headerlink" href="#typingno_type_check_decorator" title="Permanent link">&para;</a></h4>
<p>让其他装饰器具有 <a href="#typingno_type_check">no_type_check()</a> 效果的装饰器。</p>
<p>本装饰器用 <a href="#typingno_type_check">no_type_check()</a> 里的装饰函数打包其他装饰器。</p>
<h4 id="typingtype_check_only">@typing.type_check_only<a class="headerlink" href="#typingtype_check_only" title="Permanent link">&para;</a></h4>
<p>标记类或函数内不可用于运行时的装饰器。</p>
<p>在运行时，该装饰器本身不可用。实现返回的是私有类实例时，它主要是用于标记在类型存根文件中定义的类。</p>
<div class="highlight"><pre><span></span><code><span class="nd">@type_check_only</span>
<span class="k">class</span> <span class="nc">Response</span><span class="p">:</span>  <span class="c1"># private or not available at runtime</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">int</span>
    <span class="k">def</span> <span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> <span class="o">...</span>

<span class="k">def</span> <span class="nf">fetch_response</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div>
<p>注意，建议不要返回私有类实例，最好将之设为公共类。</p>
<h3 id="内省辅助器">内省辅助器<a class="headerlink" href="#内省辅助器" title="Permanent link">&para;</a></h3>
<h4 id="typingget_type_hintsobj-globalnsnone-localnsnone-include_extrasfalse">typing.get_type_hints(obj, globalns=None, localns=None, include_extras=False)<a class="headerlink" href="#typingget_type_hintsobj-globalnsnone-localnsnone-include_extrasfalse" title="Permanent link">&para;</a></h4>
<p>返回函数、方法、模块、类对象的类型提示的字典。</p>
<p>一般情况下，与 <code>obj.__annotations__</code> 相同。此外，可通过在 <code>globals</code> 与 <code>locals</code> 命名空间里进行评估，以此来处理编码为字符串字面量的前向引用。如有需要，在默认值设置为 <code>None</code> 时，可为函数或方法注解添加 <code>Optional[t]</code>。对于类 <code>C</code>，则返回由所有 <code>__annotations__</code> 与 <code>C.__mro__</code> 逆序合并而成的字典。</p>
<p>本函数以递归地方式用 <code>T</code> 替换所有 <code>Annotated[T, ...]</code>， 除非将 <code>include_extras</code> 的值设置为 <code>True</code> （详见 [Annotated]）。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;some marker&#39;</span><span class="p">]</span>

<span class="n">get_type_hints</span><span class="p">(</span><span class="n">Student</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
<span class="n">get_type_hints</span><span class="p">(</span><span class="n">Student</span><span class="p">,</span> <span class="n">include_extras</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
<span class="n">get_type_hints</span><span class="p">(</span><span class="n">Student</span><span class="p">,</span> <span class="n">include_extras</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;some marker&#39;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p><strong>注解</strong> <a href="https://docs.python.org/zh-cn/3.10/library/typing.html#typing.get_type_hints">get_type_hints()</a> 在导入的 <a href="#_2">类型别名</a> 中不工作，包括前向引用。启用注解的延迟评估（ <a href="https://www.python.org/dev/peps/pep-0563">PEP 563</a> ）可能会消除对大多数前向引用的需要。</p>
</blockquote>
<p>在 3.9 版更改: <a href="https://www.python.org/dev/peps/pep-0593">PEP 593</a> 的组成部分，添加了 <code>include_extras</code> 参数。</p>
<h4 id="typingget_argstp">typing.get_args(tp)<a class="headerlink" href="#typingget_argstp" title="Permanent link">&para;</a></h4>
<h4 id="typingget_origintp">typing.get_origin(tp)<a class="headerlink" href="#typingget_origintp" title="Permanent link">&para;</a></h4>
<p>为泛型类型与特殊类型形式提供了基本的内省功能。</p>
<p>对于 <code>X[Y, Z, ...]</code> 形式的类型对象，这些函数返回 <code>X</code> 与 <code>(Y, Z, ...)</code>。如果 X 是内置对象或 <a href="https://docs.python.org/zh-cn/3.10/library/collections.html#module-collections">collections</a> <code>class</code> 的泛型别名， 会将其标准化为原始类。如果 <code>X</code> 是包含在其他泛型类型中的联合类型或 <a href="#typingliteral">Literal</a>，<code>(Y, Z, ...)</code> 的顺序会因类型缓存，而与原始参数 <code>[Y, Z, ...]</code> 的顺序不同。对于不支持的对象会相应地返回 <code>None</code> 或 <code>()</code>。例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">assert</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">dict</span>
<span class="k">assert</span> <span class="n">get_args</span><span class="p">(</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="ow">is</span> <span class="n">Union</span>
<span class="k">assert</span> <span class="n">get_args</span><span class="p">(</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>
<p>3.8 新版功能.</p>
<h4 id="typingis_typeddicttp">typing.is_typeddict(tp)<a class="headerlink" href="#typingis_typeddicttp" title="Permanent link">&para;</a></h4>
<p>检查一个类型是否为 <a href="#class-typingtypeddictdict">TypedDict</a>。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Film</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">year</span><span class="p">:</span> <span class="nb">int</span>

<span class="n">is_typeddict</span><span class="p">(</span><span class="n">Film</span><span class="p">)</span>  <span class="c1"># =&gt; True</span>
<span class="n">is_typeddict</span><span class="p">(</span><span class="nb">list</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span>  <span class="c1"># =&gt; False</span>
</code></pre></div>
<p>3.10 新版功能.</p>
<h4 id="class-typingforwardref">class typing.ForwardRef<a class="headerlink" href="#class-typingforwardref" title="Permanent link">&para;</a></h4>
<p>用于字符串前向引用的内部类型表示的类。 例如，<code>List["SomeClass"]</code> 会被隐式转换为 <code>List[ForwardRef("SomeClass")]</code>。 这个类不应由用户来实例化，但可以由内省工具使用。</p>
<blockquote>
<p><strong>注解</strong> <a href="https://www.python.org/dev/peps/pep-0585">PEP 585</a> 泛型类型例如 <code>list["SomeClass"]</code> 将不会被隐式地转换为 <code>list[ForwardRef("SomeClass")]</code> 因而将不会自动解析为 <code>list[SomeClass]</code>。</p>
</blockquote>
<p>3.7.4 新版功能.</p>
<h3 id="常量">常量<a class="headerlink" href="#常量" title="Permanent link">&para;</a></h3>
<h4 id="typingtype_checking">typing.TYPE_CHECKING<a class="headerlink" href="#typingtype_checking" title="Permanent link">&para;</a></h4>
<p>被第三方静态类型检查器假定为 <code>True</code> 的特殊常量。 在运行时为 <code>False</code>。 用法如下:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">expensive_mod</span>

<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="s1">&#39;expensive_mod.SomeType&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">local_var</span><span class="p">:</span> <span class="n">expensive_mod</span><span class="o">.</span><span class="n">AnotherType</span> <span class="o">=</span> <span class="n">other_fun</span><span class="p">()</span>
</code></pre></div>
<p>第一个类型注解必须用引号标注，才能把它当作“前向引用”，从而在解释器运行时中隐藏 <code>expensive_mod</code> 引用。局部变量的类型注释不会被评估，因此，第二个注解不需要用引号引起来。</p>
<blockquote>
<p><strong>注解</strong> 使用 <code>from __future__ import</code> 时，函数定义时不处理注解， 而是把注解当作字符串存在 <code>__annotations__</code> 里，这样就不必为注解使用引号。（详见 <a href="https://www.python.org/dev/peps/pep-0563">PEP 563</a>）。</p>
</blockquote>
<p>3.5.2 新版功能.</p>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2023年5月4日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2023年4月27日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            回到页面顶部
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tabs.link", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.follow"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>